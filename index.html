<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Limit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><style>@keyframes rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes flow{0%,100%{stroke-dashoffset:0}50%{stroke-dashoffset:50}}.infinity{animation:rotate 10s linear infinite;transform-origin:center}.path1,.path2{fill:none;stroke-width:8;stroke-linecap:round;stroke-linejoin:round;animation:flow 3s ease-in-out infinite}.path1{stroke:%2320B2AA}.path2{stroke:%2317807A;animation-delay:-1.5s}</style><g class='infinity'><path class='path1' d='M20,50 Q35,20 50,50 T80,50'/><path class='path2' d='M20,50 Q35,80 50,50 T80,50'/></g></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    @font-face {
      font-family: 'Math Font';
      src: url('Math Font.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    
    :root {
      /* Modern, harmonious, and professional color palette */
      --primary: #6366f1; /* Indigo - more professional than purple */
      --primary-light: #a5b4fc;
      --primary-dark: #4338ca;
      --primary-pale: #eef2ff;
      
      --secondary: #64748b; /* Slate - neutral and versatile */
      --secondary-light: #cbd5e1;
      --secondary-dark: #475569;
      --secondary-pale: #f8fafc;
      
      --accent-1: #f59e0b; /* Amber - warm and inviting */
      --accent-1-light: #fde68a;
      --accent-2: #10b981; /* Emerald - fresh and positive */
      --accent-2-light: #a7f3d0;
      --accent-3: #ef4444; /* Red - attention-grabbing */
      --accent-3-light: #fecaca;
      --accent-4: #8b5cf6; /* Violet - creative and modern */
      --accent-4-light: #c4b5fd;
      
      --success: #10b981; /* Emerald */
      --success-light: #d1fae5;
      --error: #ef4444; /* Red */
      --error-light: #fee2e2;
      --warning: #f59e0b; /* Amber */
      --warning-light: #fef3c7;
      --info: #3b82f6; /* Blue */
      --info-light: #dbeafe;
      
      --text-primary: #1e293b; /* Slate 800 */
      --text-secondary: #64748b; /* Slate 500 */
      --text-tertiary: #94a3b8; /* Slate 400 */
      --text-on-color: #ffffff;
      
      --bg-primary: #f8fafc; /* Slate 50 */
      --bg-secondary: #f1f5f9; /* Slate 100 */
      --bg-tertiary: #e2e8f0; /* Slate 200 */
      --bg-quaternary: #cbd5e1; /* Slate 300 */
      
      --border: #e2e8f0; /* Slate 200 */
      --border-light: #f1f5f9; /* Slate 100 */
      --border-dark: #cbd5e1; /* Slate 300 */
      
      --card-bg: #ffffff;
      --card-hover: #f8fafc; /* Slate 50 */
      --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
      --card-shadow-hover: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);
      
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
      --radius-sm: 8px;
      --radius: 12px;
      --radius-lg: 16px;
      --transition: 200ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-serif: 'Roboto Slab', serif;
      --font-math: 'Math Font', serif;
    }

    /* Dark Theme - Modern and Professional */
    [data-theme="dark"] {
      --primary: #6366f1; /* Keep consistent primary */
      --primary-light: #818cf8;
      --primary-dark: #4338ca;
      --primary-pale: #1e1b4b;
      
      --secondary: #94a3b8; /* Lighter slate for dark mode */
      --secondary-light: #cbd5e1;
      --secondary-dark: #64748b;
      --secondary-pale: #1e293b;
      
      --accent-1: #fbbf24; /* Brighter amber for dark mode */
      --accent-1-light: #f59e0b;
      --accent-2: #34d399; /* Brighter emerald */
      --accent-2-light: #10b981;
      --accent-3: #f87171; /* Brighter red */
      --accent-3-light: #ef4444;
      --accent-4: #a78bfa; /* Brighter violet */
      --accent-4-light: #8b5cf6;
      
      --success: #34d399; /* Brighter emerald */
      --success-light: #10b981;
      --error: #f87171; /* Brighter red */
      --error-light: #ef4444;
      --warning: #fbbf24; /* Brighter amber */
      --warning-light: #f59e0b;
      --info: #60a5fa; /* Brighter blue */
      --info-light: #3b82f6;
      
      --text-primary: #f1f5f9; /* Slate 100 */
      --text-secondary: #cbd5e1; /* Slate 300 */
      --text-tertiary: #94a3b8; /* Slate 400 */
      --text-on-color: #ffffff;
      
      --bg-primary: #0f172a; /* Slate 900 */
      --bg-secondary: #1e293b; /* Slate 800 */
      --bg-tertiary: #334155; /* Slate 700 */
      --bg-quaternary: #475569; /* Slate 600 */
      
      --border: #334155; /* Slate 700 */
      --border-light: #475569; /* Slate 600 */
      --border-dark: #64748b; /* Slate 500 */
      
      --card-bg: #1e293b; /* Slate 800 */
      --card-hover: #334155; /* Slate 700 */
      --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2);
      --card-shadow-hover: 0 4px 6px rgba(0, 0, 0, 0.3), 0 2px 4px rgba(0, 0, 0, 0.2);
      
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2);
      --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.3), 0 2px 4px rgba(0, 0, 0, 0.2);
      --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.3), 0 4px 6px rgba(0, 0, 0, 0.2);
    }

    /* System preference for dark mode */
    @media (prefers-color-scheme: dark) {
      :root:not([data-theme="light"]) {
        --primary: #6366f1; /* Keep consistent primary */
        --primary-light: #818cf8;
        --primary-dark: #4338ca;
        --primary-pale: #1e1b4b;
        
        --secondary: #94a3b8; /* Lighter slate for dark mode */
        --secondary-light: #cbd5e1;
        --secondary-dark: #64748b;
        --secondary-pale: #1e293b;
        
        --accent-1: #fbbf24; /* Brighter amber for dark mode */
        --accent-1-light: #f59e0b;
        --accent-2: #34d399; /* Brighter emerald */
        --accent-2-light: #10b981;
        --accent-3: #f87171; /* Brighter red */
        --accent-3-light: #ef4444;
        --accent-4: #a78bfa; /* Brighter violet */
        --accent-4-light: #8b5cf6;
        
        --success: #34d399; /* Brighter emerald */
        --success-light: #10b981;
        --error: #f87171; /* Brighter red */
        --error-light: #ef4444;
        --warning: #fbbf24; /* Brighter amber */
        --warning-light: #f59e0b;
        --info: #60a5fa; /* Brighter blue */
        --info-light: #3b82f6;
        
        --text-primary: #f1f5f9; /* Slate 100 */
        --text-secondary: #cbd5e1; /* Slate 300 */
        --text-tertiary: #94a3b8; /* Slate 400 */
        --text-on-color: #ffffff;
        
        --bg-primary: #0f172a; /* Slate 900 */
        --bg-secondary: #1e293b; /* Slate 800 */
        --bg-tertiary: #334155; /* Slate 700 */
        --bg-quaternary: #475569; /* Slate 600 */
        
        --border: #334155; /* Slate 700 */
        --border-light: #475569; /* Slate 600 */
        --border-dark: #64748b; /* Slate 500 */
        
        --card-bg: #1e293b; /* Slate 800 */
        --card-hover: #334155; /* Slate 700 */
        --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2);
        --card-shadow-hover: 0 4px 6px rgba(0, 0, 0, 0.3), 0 2px 4px rgba(0, 0, 0, 0.2);
        
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
        --shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2);
        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.3), 0 2px 4px rgba(0, 0, 0, 0.2);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.3), 0 4px 6px rgba(0, 0, 0, 0.2);
      }
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: 'Roboto Slab', serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      transition: background-color var(--transition), color var(--transition);
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      min-height: 100vh;
    }

    /* Typography */
    h1, h2, h3, h4, h5, h6 {
      color: var(--text-primary);
      font-weight: 600;
      margin-bottom: 1.5rem;
      letter-spacing: -0.025em;
      line-height: 1.3;
      font-family: var(--font-serif);
    }

    h1 { font-size: 2.25rem; }
    h2 { font-size: 1.875rem; }
    h3 { font-size: 1.5rem; }
    h4 { font-size: 1.25rem; }

    p { margin-bottom: 1rem; }

    /* Cards */
    .card-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(700px, 1fr));
      gap: 1.5rem;
      margin-top: 1.5rem;
      max-width: 1800px;
      margin-left: auto;
      margin-right: auto;
    }

    .card, .modal, .form-page, .quiz-container {
      border-radius: var(--radius-lg);
      box-shadow: var(--card-shadow);
      border: 1.5px solid var(--border);
      background: linear-gradient(120deg, var(--card-bg) 80%, var(--primary-pale) 100%);
      transition: box-shadow var(--transition), border-color var(--transition), background var(--transition), transform var(--transition);
    }
    .card:hover, .modal:hover, .form-page:hover, .quiz-container:hover {
      /* Remove zoom/scale/transform on hover */
      box-shadow: var(--card-shadow-hover);
      border-color: var(--primary-light);
      background: var(--card-hover);
      /* transform: translateY(-2px) scale(1.01); */
    }

    .card {
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-width: 700px;
      max-width: 100%;
      min-height: 180px;
      padding: 2.25rem 2.5rem 1.75rem 2.5rem;
      margin-bottom: 1.5rem;
      will-change: transform, box-shadow, border-color;
      transition: transform var(--transition-fast) ease-out, 
                  box-shadow var(--transition-fast) ease-out,
                  border-color var(--transition-fast) ease-out;
      backface-visibility: hidden;
      -webkit-font-smoothing: subpixel-antialiased;
    }
    
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.12), 0 2px 8px rgba(0,0,0,0.06);
      border-color: var(--primary-light);
    }

    .card-header {
      padding: 0;
      border: none;
      background: none;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .card-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
      font-family: var(--font-serif);
    }

    .card-desc {
      color: var(--text-secondary);
      font-size: 1.1rem;
      margin-bottom: 0.75rem;
    }

    .card-badges {
      display: flex;
      gap: 0.75rem;
      margin-bottom: 1.25rem;
    }

    .badge {
      display: inline-block;
      padding: 0.4em 1.2em;
      border-radius: 999px;
      font-size: 1rem;
      font-weight: 500;
      background: #f1f5f9;
      color: #64748b;
      letter-spacing: 0.01em;
      font-family: var(--font-serif);
    }
    .badge.unlocked { background: #e6f9ec; color: #2e7d32; }
    .badge.locked { background: #fbe9e7; color: #d32f2f; }
    .badge.visible { background: #e3e8fd; color: #3b5bdb; }
    .badge.hidden { background: #f8fafc; color: #64748b; }

    .card-actions {
      display: flex;
      gap: 2rem;
      align-items: center;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .card-actions .icon-btn {
      background: none;
      border: none;
      box-shadow: none;
      padding: 0.5rem;
      border-radius: 0.75rem;
      transition: background 0.2s;
      font-size: 1.5rem;
      color: var(--text-primary);
    }
    .card-actions .icon-btn:hover {
      background: var(--bg-secondary);
      color: var(--primary-dark);
    }
    .card-actions .icon-btn img {
      width: 2rem;
      height: 2rem;
      opacity: 0.9;
    }

    .card-body {
      padding: 1.5rem;
      flex: 1;
      color: var(--text-secondary);
      font-size: 0.9375rem;
      line-height: 1.6;
    }

    .card-footer {
      padding: 1.25rem 1.5rem;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border);
    }

    .progress-group {
      margin-bottom: 1rem;
    }

    .progress-group:last-child {
      margin-bottom: 0;
    }

    /* Module Card Specific */
    .module-card .card-header {
      background: var(--primary);
      padding: 1.75rem 1.5rem;
      /* Non-empty ruleset to fix lint */
      overflow: visible;
    }

    /* Enhanced text overflow with line-clamp */
    .question-card .summary {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      line-clamp: 2;
      max-height: 3.6em; /* 2 lines * 1.8 line-height */
      word-break: break-word;
      hyphens: auto;
      /* Standard property for future compatibility */
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-box-pack: end;
      box-orient: vertical;
      box-pack: end;
    }
    .module-card .card-header-content strong {
      color: white;
      font-size: 1.25rem;
      margin-bottom: 0.75rem;
      display: block; /* Ensure proper spacing */
      line-height: 1.4; /* Add line height for better text rendering */
    }

    .module-card .card-header-content .summary {
      color: rgba(255, 255, 255, 0.9);
    }

    .module-card .card-header-content small {
      color: rgba(255, 255, 255, 0.8);
    }

    .module-card .start-btn {
      background: white;
      color: var(--primary-dark);
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius);
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all var(--transition);
      box-shadow: var(--shadow);
      margin-top: 1rem;
    }

    .module-card .start-btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
      background: var(--bg-primary);
    }

    /* Question Card Specific */
    .question-card {
      /* transition: all 0.3s ease; Removed hover animation */
      display: block;
    }

    .question-card .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 1.5rem;
      gap: 1rem;
    }

    .question-card .summary {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      max-height: 2.8em;
      color: #666;
      font-size: 0.9rem;
      line-height: 1.4;
      margin-top: 0.5rem;
    }

.question-card .tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 0.75rem;
}

/* Highlighted Question Card */
.question-card.highlighted {
  animation: highlightPulse 2s ease-in-out;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
  transition: box-shadow 0.3s ease-in-out;
}

@keyframes highlightPulse {
  0% {
    box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
    transform: translateY(0);
  }
  50% {
    box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
    transform: translateY(-2px);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
    transform: translateY(0);
  }
}

.question-card .tag {
  display: inline-block;
  padding: 0.25rem 0.75rem;
  border-radius: 999px;
  font-size: 0.875rem;
  background: var(--bg-secondary);
  color: var(--text-secondary);
  border: 1px solid var(--border);
}

    .question-card .full-text {
      display: none;
      /* Ensure proper content flow when visible */
      margin: 0.5rem 0;
    }

    .question-card.expanded .summary {
      display: none;
    }

    .question-card.expanded .full-text {
      display: block;
    }

    .question-card .card-body {
      display: none;
      padding: 1.5rem;
      color: var(--text-secondary);
      border-top: 1px solid var(--border);
    }

    .question-card.expanded .card-body {
      display: block;
      animation: slideDown 0.3s ease-out;
    }

    .question-card .card-actions {
      display: flex;
      gap: 0.5rem;
      flex-shrink: 0;
    }

    .question-card .icon-btn img {
      width: 1.25rem;
      height: 1.25rem;
      /* transition: transform 0.3s ease; */ /* Removed hover animation */
    }

    /* Search Icon Positioning */
    .search-group {
      position: relative;
    }

    .search-group .search-icon {
      position: absolute;
      left: 1.25rem;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      z-index: 1;
    }

    .search-group .search-icon img {
      width: 1.5rem;
      height: 1.5rem;
      opacity: 0.6;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Rich Text Editor Improvements */
    .rich-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.375rem;
      padding: 0.75rem;
      background: var(--bg-secondary);
      border: 2px solid var(--border);
      border-bottom: none;
      border-radius: var(--radius-sm) var(--radius-sm) 0 0;
    }

    .rich-toolbar-group {
      display: flex;
      gap: 0.375rem;
      padding-right: 0.75rem;
      margin-right: 0.75rem;
      border-right: 1px solid var(--border);
    }

    .rich-toolbar-group:last-child {
      border-right: none;
      margin-right: 0;
      padding-right: 0;
    }

    .rich-toolbar button {
      width: 2rem;
      height: 2rem;
      padding: 0.375rem;
      border-radius: var(--radius-sm);
      background: transparent;
      border: 1px solid transparent;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition);
    }

    .rich-toolbar .file-input {
      display: none;
    }

    .rich-toolbar .file-label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.375rem 0.75rem;
      border-radius: var(--radius-sm);
      background: transparent;
      border: 1px solid transparent;
      cursor: pointer;
      font-size: 0.875rem;
      color: var(--text-secondary);
      transition: all var(--transition);
    }

    .rich-toolbar .file-label:hover {
      background: var(--bg-primary);
      border-color: var(--border);
    }

    .rich-toolbar img {
      width: 1.125rem;
      height: 1.125rem;
      opacity: 0.75;
      transition: all var(--transition);
    }

    .rich-toolbar button:hover {
      background: var(--bg-primary);
      border-color: var(--border);
      transform: translateY(-1px);
    }

    .rich-toolbar button.active {
      background: var(--secondary);
      border-color: var(--primary);
    }

    .rich-toolbar button.active img {
      filter: brightness(0) invert(1);
      opacity: 1;
    }
    
    /* Math Font Button Styles */
    button[data-cmd="mathFont"] {
      position: relative;
      width: 2rem;
      height: 2rem;
      min-width: 0;
      background: transparent;
      border: 1px solid transparent;
      border-radius: var(--radius-sm);
      padding: 0.375rem;
      margin-left: 0.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var(--transition);
    }
    
    button[data-cmd="mathFont"]:hover {
      background: var(--bg-primary);
      border-color: var(--border);
    }

    button[data-cmd="mathFont"].active {
      background: var(--secondary);
      border-color: var(--primary);
    }

    button[data-cmd="mathFont"].active img {
      filter: brightness(0) invert(1);
      opacity: 1;
    }

    [contenteditable="true"] {
      min-height: 120px;
      padding: 1.25rem;
      border: 2px solid var(--border);
      border-radius: 0 0 var(--radius-sm) var(--radius-sm);
      outline: none;
      transition: all var(--transition);
      background: var(--bg-primary);
      font-size: 1.1rem;
      line-height: 1.8;
    }

    [contenteditable="true"].math-font {
      font-family: var(--font-math);
    }

    [contenteditable="true"]:hover {
      border-color: var(--primary-light);
    }

    [contenteditable="true"]:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(var(--primary), 0.15);
    }

    [contenteditable="true"] ul,
    [contenteditable="true"] ol {
      padding-left: 1.5rem;
      margin: 0.5rem 0;
    }

    [contenteditable="true"] li {
      margin-bottom: 0.375rem;
    }

    [contenteditable="true"] ul li {
      list-style-type: disc;
    }

    [contenteditable="true"] ul li li {
      list-style-type: circle;
    }

    [contenteditable="true"] ul li li li {
      list-style-type: square;
    }

    [contenteditable="true"] ol li {
      list-style-type: decimal;
    }

    [contenteditable="true"] ol li li {
      list-style-type: lower-alpha;
    }

    [contenteditable="true"] ol li li li {
      list-style-type: lower-roman;
    }

    /* MCQ Options */
    .option-group {
      margin-bottom: 1.25rem;
      background: var(--bg-primary);
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }

    .option-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      border-bottom: 1px solid var(--border);
    }

    .option-content {
      padding: 1rem;
    }

    .option-toolbar {
      border: none;
      border-radius: var(--radius-sm);
      background: var(--bg-secondary);
      margin-bottom: 0.5rem;
    }

    /* Modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(26, 32, 39, 0.7);
      backdrop-filter: blur(8px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 50;
      padding: 1.5rem;
      opacity: 0;
      transition: opacity 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    .modal-backdrop[style*="display: flex"] {
      opacity: 1;
    }

    .modal {
      background: white;
      border-radius: var(--radius-lg);
      width: 95%;
      max-width: 1200px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      animation: modalFadeIn 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
      will-change: transform, opacity;
      transform: translateY(20px);
      opacity: 0;
      padding: 2.5rem;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
    }

    @keyframes modalFadeIn {
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-body {
      padding: 1.5rem 0;
      overflow-y: auto;
      max-height: calc(90vh - 100px);
      line-height: 1.5;
      scrollbar-width: thin;
      scrollbar-color: var(--primary-light) transparent;
    }
    
    /* Improve text readability in modals */
    .modal p,
    .modal li,
    .modal .text-content {
      line-height: 1.5;
      margin-bottom: 0.75rem;
    }
    
    /* Adjust quiz content spacing */
    .quiz-content p,
    .quiz-content .question-text,
    .quiz-content .explanation {
      line-height: 1.5;
      margin-bottom: 0.75rem;
    }
    
    .quiz-content p:last-child,
    .quiz-content .explanation:last-child {
      margin-bottom: 0;
    }
    
    /* Ensure question cards in modal use full width */
    .modal-body .question-card {
      width: 100%;
      max-width: 100%;
      margin-bottom: 1.5rem;
    }

    /* Navigation */
    nav {
      background: var(--bg-primary);
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 40;
      backdrop-filter: blur(8px);
    }
    
    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1800px;
      margin: 0 auto;
      padding: 0.75rem 2rem;
    }
    
    .nav-brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 1.5rem;
      font-weight: 700;
      text-decoration: none;
    }
    
    .logo-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      background: rgba(32, 178, 170, 0.1);
      border-radius: 8px;
      padding: 6px;
    }
    
    .app-name {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 800;
      letter-spacing: -0.5px;
    }
    
    .app-name span {
      color: var(--primary-dark);
      -webkit-text-fill-color: var(--primary-dark);
      font-weight: 600;
    }
    
    .nav-brand:hover {
      /* transform: translateY(-1px); Removed hover animation */
      opacity: 1;
    }
    
    .nav-brand img {
      width: 2.2rem;
      height: 2.2rem;
      filter: drop-shadow(0 2px 4px rgba(var(--primary) 0.2));
    }

    .nav-links {
      display: flex;
      gap: 0.5rem;
      background: var(--bg-secondary);
      padding: 0.3rem;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      box-shadow: 0 2px 8px rgba(0,0,0,0.03);
    }
    
    .nav-btn {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.7rem 1.2rem;
      background: transparent;
      border: none;
      border-radius: var(--radius-sm);
      font-weight: 600;
      font-size: 0.95rem;
      color: var(--text-secondary);
      transition: all 0.2s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    
    .nav-btn::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 3px;
      background: var(--primary);
      transition: all 0.3s ease;
      transform: translateX(-50%);
      border-radius: 3px 3px 0 0;
      opacity: 0;
    }
    
    .nav-btn img {
      width: 1.3rem;
      height: 1.3rem;
      opacity: 0.8;
      transition: all 0.2s ease;
    }
    
    .nav-btn:hover {
      background: var(--bg-primary);
      color: var(--primary);
      /* transform: translateY(-2px); */ /* Removed hover animation */
      /* box-shadow: 0 3px 6px rgba(0,0,0,0.05); */ /* Removed hover animation */
    }
    
    .nav-btn:hover::after {
      width: 40%;
      opacity: 0.7;
    }
    
    .nav-btn:hover img {
      opacity: 1;
      transform: scale(1.1);
    }
    
    .nav-btn.active {
      background: var(--primary);
      color: white;
      box-shadow: var(--shadow-sm);
    }
    
    .nav-btn.active::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 10%;
      width: 80%;
      height: 3px;
      opacity: 1;
      background: var(--primary-light);
      border-radius: 3px;
      transition: all var(--transition-fast) ease-out;
    }
    
    .nav-btn.active img {
      opacity: 1;
      filter: brightness(0) invert(1);
      transform: scale(1.1);
    }

    /* Main Content */
    main {
      max-width: 1200px;
      margin: 2.5rem auto;
      padding: 0 1.5rem;
    }

    .page {
      display: none;
      animation: fadeIn 150ms cubic-bezier(0.4, 0, 0.2, 1);
      will-change: opacity, transform;
      transform: translateZ(0);
    }

    .page.active {
      display: block;
    }

    /* Cards */
    .card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
      border-color: var(--primary-light);
    }

    .card-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1rem;
    }

    .card-header strong {
      font-size: 1.125rem;
      display: block;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
    }

    .card-body {
      padding: 1.5rem;
      flex: 1;
    }

    .card-footer {
      padding: 1.25rem 1.5rem;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border);
      display: flex;
      gap: 0.75rem;
      justify-content: flex-end;
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.875rem 1.75rem;
      font-size: 0.95rem;
      font-weight: 600;
      font-family: var(--font-sans);
      border: none;
      border-radius: 16px; /* Less rounded than before */
      cursor: pointer;
      transition: all var(--transition);
      text-decoration: none;
      background: var(--primary);
      color: var(--text-on-color);
      box-shadow: var(--shadow-sm);
      position: relative;
      overflow: hidden;
    }
    
    .btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow);
      background: var(--primary-dark);
    }
    
    .btn:active {
      transform: translateY(0);
      box-shadow: var(--shadow-sm);
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
      box-shadow: var(--shadow-sm);
    }
    
    .btn-secondary {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border);
    }
    
    .btn-secondary:hover {
      background: var(--bg-quaternary);
      color: var(--text-primary);
    }
    
    .btn-outline {
      background: transparent;
      color: var(--primary);
      border: 2px solid var(--primary);
    }
    
    .btn-outline:hover {
      background: var(--primary);
      color: var(--text-on-color);
    }
    
    /* Quiz-specific button styles */
    .quiz-option, .next-btn, .start-btn {
      border-radius: 14px; /* Slightly less rounded for quiz buttons */
      font-weight: 600;
      transition: all var(--transition);
    }
    
    .quiz-option {
      background: var(--card-bg);
      color: var(--text-primary);
      border: 2px solid var(--border);
      padding: 1rem 1.5rem;
      margin: 0.5rem 0;
      width: 100%;
      text-align: left;
      font-size: 1rem;
    }
    
    .quiz-option:hover {
      background: var(--primary-pale);
      border-color: var(--primary);
      transform: translateY(-1px);
      box-shadow: var(--shadow);
    }
    
    .quiz-option.correct {
      background: var(--success-light);
      border-color: var(--success);
      color: var(--success);
    }
    
    .quiz-option.incorrect {
      background: var(--error-light);
      border-color: var(--error);
      color: var(--error);
    }
    
    .next-btn {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: var(--text-on-color);
      padding: 1rem 2rem;
      font-size: 1.1rem;
      box-shadow: var(--shadow);
    }
    
    .next-btn:hover {
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
      box-shadow: var(--shadow-md);
    }
    
    .start-btn {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: var(--text-on-color);
      padding: 1.2rem 2rem;
      font-size: 1.2rem;
      box-shadow: var(--shadow);
    }
    
    .start-btn:hover {
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }
    
    .start-btn:disabled {
      background: var(--bg-tertiary);
      color: var(--text-tertiary);
      cursor: not-allowed;
      transform: none;
      box-shadow: var(--shadow-sm);
    }

    .btn-success {
      background: var(--success);
    }

    .btn-error {
      background: var(--error);
    }

    .btn img {
      width: 1.25rem;
      height: 1.25rem;
      opacity: 0.9;
    }

    .icon-btn {
      padding: 0.5rem;
      border-radius: var(--radius-sm);
      background: transparent;
      color: var(--text-secondary);
      transition: all var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .icon-btn:hover {
      background: var(--bg-secondary);
      color: var(--primary-dark);
    }

    .icon-btn img {
      width: 1.375rem;
      height: 1.375rem;
      opacity: 0.75;
      transition: opacity var(--transition);
    }

    .icon-btn:hover img {
      opacity: 1;
    }

    /* Forms */
    .form-group {
      margin-bottom: 1.75rem;
      width: 100%;
    }

    .form-group label {
      display: block;
      font-weight: 500;
      margin-bottom: 0.625rem;
      color: var(--text-secondary);
    }

    .form-control {
      width: 100%;
      padding: 1.125rem 1.5rem;
      font-size: 1.2rem;
      line-height: 1.8;
      color: var(--text-primary);
      background-color: var(--bg-primary);
      border: 2px solid var(--border);
      border-radius: var(--radius);
      transition: all var(--transition);
    }

    .form-control:hover {
      border-color: var(--primary-light);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(var(--primary), 0.15);
    }

    select.form-control {
      appearance: none;
      background-image: url('data:image/svg+xml;charset=US-ASCII,<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position: right 1rem center;
      padding-right: 2.5rem;
    }

    /* Quiz */
    .quiz-container {
      max-width: 1800px;
      width: 98vw;
      margin: 0 auto;
      padding: 2.5rem 2.5rem 2.5rem 2.5rem;
      background: linear-gradient(120deg, var(--card-bg) 80%, var(--primary-pale) 100%);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    @media (max-width: 1200px) {
      .quiz-container {
        padding: 2rem 0;
      }
    }
    @media (max-width: 768px) {
      .quiz-container {
        padding: 1.5rem 0;
        margin: 0;
      }
    }

    .quiz-question {
      font-size: 1.5rem;
      line-height: 1.5;
      margin-bottom: 2rem;
      text-align: left;
      width: 100%;
      color: var(--text-primary);
      font-weight: 500;
      letter-spacing: -0.01em;
    }
    
    .quiz-content {
      font-size: 1.1rem;
      line-height: 1.6;
      color: var(--text-secondary);
      margin-bottom: 2rem;
    }
    
    .quiz-content p {
      margin-bottom: 1.25rem;
    }
    
    .quiz-content p:last-child {
      margin-bottom: 0;
    }
    
    .quiz-content img {
      max-width: 100%;
      height: auto;
      border-radius: var(--radius);
      margin: 1.5rem 0;
    }

    .quiz-options {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin: 2.5rem 0;
    }

    .quiz-option {
      padding: 1rem 1.5rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--bg-secondary);
      transition: all 0.2s ease;
      cursor: pointer;
      text-align: left;
      font-size: 1.05rem;
      line-height: 1.5;
    }

    .quiz-option:hover {
      background: var(--bg-tertiary);
      border-color: var(--primary);
    }

    .quiz-question {
      font-weight: 500;
      margin-bottom: 2.5rem;
      text-align: left;
      width: 100%;
    }

    .question-text {
      font-family: var(--font-serif);
      font-size: 1.8rem;
      line-height: 1.5;
      margin: 1.5rem 0;
      text-align: left;
      font-weight: 400;
      color: var(--text-primary);
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    .question-number {
      font-size: 0.875rem;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
      font-weight: 500;
    }

    .quiz-options {
      list-style: none;
      margin: 1.75rem 0;
    }

    .quiz-options li {
      margin-bottom: 1rem;
    }

    .quiz-options button {
      width: 100%;
      text-align: left;
      padding: 1.25rem;
      background: var(--bg-secondary);
      border: 2px solid var(--border);
      border-radius: var(--radius);
      font-size: 1.2rem;
      transition: all var(--transition);
      line-height: 1.8;
    }

    .quiz-options button:hover {
      background: var(--bg-secondary);
      border-color: var(--primary-light);
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .quiz-options button.correct {
      background: #ebfbee;
      border: 2px solid #2e7d32;
      color: #2e7d32;
      font-weight: 600;
      position: relative;
    }

    .quiz-options button.correct::before {
      content: '✓';
      color: #2e7d32;
      font-size: 1.1rem;
      margin-right: 0.5rem;
    }

    .quiz-options button.incorrect {
      background: #fff5f5;
      border: 2px solid #d32f2f;
      color: #d32f2f;
      font-weight: 600;
      position: relative;
    }

    .quiz-options button.incorrect::before {
      content: '✗';
      color: #d32f2f;
      font-size: 1.1rem;
      margin-right: 0.5rem;
    }

    /* Progress Bars */
    .progress-container {
      margin-bottom: 1.75rem;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.75rem;
      font-size: 0.875rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .progress {
      height: 0.5rem;
      background: var(--bg-tertiary);
      border-radius: 9999px;
      overflow: hidden;
      box-shadow: 0 1px 2px rgba(30,64,175,0.04);
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--primary-light));
      border-radius: 9999px;
      transition: width var(--transition), background var(--transition);
    }

    /* Feedback */
    .feedback {
      padding: 1.5rem;
      border-radius: var(--radius-lg);
      margin: 1.75rem 0;
      animation: fadeIn 0.3s ease-out;
      min-height: unset;
      padding: 1rem 1.25rem;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .feedback-header {
      margin-bottom: 1rem;
      font-size: 1.25rem;
    }

    .feedback-body {
      margin-bottom: 1.5rem;
      color: var(--text-secondary);
      font-size: 1.2rem;
      line-height: 1.8;
    }

    .feedback.correct {
      background: #ebfbee;
      border: 1px solid #8ce99a;
      color: #2b8a3e;
    }

    .feedback.incorrect {
      background: #fff5f5;
      border: 1px solid #ffa8a8;
      color: #c92a2a;
    }

    /* Summary */
    .summary {
      color: var(--text-secondary);
      font-size: 0.9375rem;
      line-height: 1.6;
      margin-top: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      max-height: 3em;
    }

    /* Empty States */
    .empty-state {
      text-align: center;
      padding: 3rem 1.5rem;
      color: var(--text-secondary);
    }

    .loading {
      text-align: center;
      padding: 2rem;
      color: var(--text-secondary);
      font-style: italic;
    }

    /* Animations */
    @keyframes fadeIn {
      from { 
        opacity: 0;
        transform: translateY(2px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideIn {
      from { 
        opacity: 0;
        transform: translateY(8px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Back to top button */
    #back-to-top {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-md);
      opacity: 0;
      visibility: hidden;
      transform: translateY(1rem);
      transition: all var(--transition) ease-in-out;
      z-index: 100;
    }

    #back-to-top:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(32, 178, 170, 0.3);
    }

    #back-to-top.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    #back-to-top svg {
      width: 1.5rem;
      height: 1.5rem;
    }

    /* Toast progress bar */
    .toast .progress {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 3px;
      width: 100%;
      background: rgba(0, 0, 0, 0.05);
      overflow: hidden;
    }
    
    .toast .progress::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      height: 100%;
      width: 100%;
      transform-origin: left;
    }
    
    .toast.info .progress::after { background: var(--info); }
    .toast.success .progress::after { background: var(--success); }
    .toast.error .progress::after { background: var(--error); }
    .toast.warning .progress::after { background: var(--warning); }
    
    @keyframes toastProgress {
      from { transform: scaleX(1); }
      to { transform: scaleX(0); }
    }
    
    @keyframes toastIn {
      0% { 
        transform: translateY(100px) scale(0.9); 
        opacity: 0;
      }
      70% { 
        transform: translateY(-10px) scale(1.02); 
        opacity: 1;
      }
      100% { 
        transform: translateY(0) scale(1); 
        opacity: 1;
      }
    }
    
    @keyframes toastOut {
      0% { 
        transform: translateY(0) scale(1); 
        opacity: 1;
        max-height: 200px;
        margin-bottom: 12px;
      }
      30% { 
        transform: translateY(-20px) scale(0.98); 
        opacity: 0.8;
      }
      100% { 
        transform: translateY(-40px) scale(0.95); 
        opacity: 0;
        max-height: 0;
        margin-bottom: 0;
        padding-top: 0;
        padding-bottom: 0;
      }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .nav-container {
        flex-direction: column;
        gap: 1rem;
      }
      .card-list {
        grid-template-columns: 1fr;
        max-width: 100%;
      }
      .card {
        min-width: 0;
        width: 100%;
      }
      .quiz-container {
        padding: 1.5rem;
        margin: 1rem;
        max-width: calc(100% - 2rem);
      }
      
      .quiz-question {
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
      }
      
      .quiz-option {
        padding: 0.8rem 1rem;
        font-size: 1rem;
      }
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 10px;
      background: var(--bg-secondary);
      border-radius: 8px;
    }
    ::-webkit-scrollbar-thumb {
      background: var(--primary-light);
      border-radius: 8px;
      border: 2px solid var(--bg-secondary);
    }
    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary);
    }

    /* Modern Action Bar */
    .action-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.2rem;
      margin-bottom: 2rem;
      background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
      padding: 0.9rem 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);
      border: 1px solid rgba(0, 0, 0, 0.04);
      flex-wrap: wrap;
      min-height: 0;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .action-bar::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(to bottom, var(--primary), var(--primary-light));
    }
    
    .action-bar .search-group {
      flex: 1 1 350px;
      max-width: 500px;
      margin-right: 1.2rem;
      display: flex;
      align-items: center;
      position: relative;
    }
    
    .action-bar .search-group input.form-control {
      background: #fff;
      border: 1.5px solid #e0e0e0;
      border-radius: 8px;
      font-size: 0.95rem;
      color: var(--text-primary);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
      padding: 0.7rem 1.2rem 0.7rem 3rem;
      transition: all 0.3s ease;
      width: 100%;
    }
    
    .action-bar .search-group input.form-control:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255, 112, 67, 0.15);
      outline: none;
    }
    
    .action-bar .search-icon {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: #9e9e9e;
      pointer-events: none;
      transition: color 0.2s;
    }
    
    .action-bar .search-group:focus-within .search-icon {
      color: var(--primary);
    }
    
    .action-bar .action-btn-group {
      display: flex;
      gap: 0.8rem;
      margin-left: auto;
      align-items: center;
    }
    
    .action-bar .action-btn {
      background: var(--primary);
      color: #fff;
      border-radius: 8px;
      font-weight: 600;
      border: none;
      box-shadow: 0 2px 10px rgba(255, 112, 67, 0.15);
      padding: 0.7rem 1.4rem;
      font-size: 0.95rem;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      position: relative;
      overflow: hidden;
    }
    
    .action-bar .action-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%, -50%);
      transform-origin: 50% 50%;
    }
    
    .action-bar .action-btn:focus:not(:active)::after {
      animation: ripple 0.6s ease-out;
    }
    
    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      100% {
        transform: scale(20, 20);
        opacity: 0;
      }
    }
    
    .action-bar .action-btn.secondary {
      background: #fff;
      color: var(--primary);
      border: 1.5px solid var(--primary-light);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    }
    
    .action-bar .action-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(255, 112, 67, 0.25);
    }
    
    .action-bar .action-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    
    .action-bar .action-btn.secondary:hover {
      background: #f8f9fa;
      border-color: var(--primary);
    }
    
    .action-bar .action-btn img {
      width: 18px;
      height: 18px;
      transition: transform 0.2s;
    }
    
    .action-bar .action-btn:hover img {
      transform: translateX(-2px);
    }
    
    @media (max-width: 900px) {
      .action-bar {
        flex-direction: column;
        align-items: stretch;
        gap: 1rem;
        padding: 1rem;
      }
      
      .action-bar::before {
        width: 100%;
        height: 4px;
      }
      
      .action-bar .search-group {
        margin: 0 0 0.5rem 0;
        max-width: 100%;
      }
      
      .action-bar .action-btn-group {
        width: 100%;
        justify-content: stretch;
      }
      
      .action-bar .action-btn {
        flex: 1;
        justify-content: center;
        padding: 0.75rem 1rem;
        margin-left: 0;
      }
    }

    .search-group {
      position: relative;
      flex: 1;
      max-width: 500px;
      transition: all 0.3s ease;
      border-radius: 7px;
      padding: 0.2rem 0.5rem;
      background: var(--bg-secondary);
    }

    .search-group:focus-within {
      transform: translateY(-1px);
    }

    .search-group input.form-control {
      width: 100%;
      padding: 0.5rem 1rem 0.5rem 2.5rem;
      border-radius: 7px;
      border: 1px solid var(--border);
      background: var(--bg-secondary);
      font-size: 0.97rem;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .search-group input.form-control:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(var(--primary), 0.1);
    }

    .search-icon {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      pointer-events: none;
    }

    .search-icon img {
      width: 1.1rem;
      height: 1.1rem;
      opacity: 0.7;
      transition: opacity 0.2s ease;
    }

    .search-group:focus-within .search-icon img {
      opacity: 1;
    }

    .action-btn {
      background: var(--primary);
      color: white;
      font-weight: 600;
      padding: 0.7rem 1.25rem;
      border-radius: 8px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px rgba(255, 112, 67, 0.2);
      border: none;
      cursor: pointer;
      font-size: 0.9rem;
      white-space: nowrap;
      position: relative;
      overflow: hidden;
      min-width: 120px;
    }

    .action-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: all 0.6s ease;
      opacity: 0;
    }

    .action-btn:hover::after {
      width: 0%;
      height: 0%;
      opacity: 0;
    }

    .action-btn img {
      width: 1.1rem;
      height: 1.1rem;
      opacity: 0.95;
      transition: transform 0.2s ease;
    }

    .action-btn:hover {
      background: var(--primary-light);
    }

    .action-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 6px rgba(255, 112, 67, 0.15);
    }

    .action-btn.secondary {
      background: var(--bg-primary);
      color: var(--primary);
      border: 1px solid var(--primary-light);
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
    }

    .action-btn.secondary:hover {
      background: var(--bg-secondary);
      border-color: var(--primary-dark);
      color: var(--primary-dark);
    }

    .action-btn.secondary:active {
      transform: translateY(0);
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
    }

    /* Action Bar Button Group */
    .action-btn-group {
      display: flex;
      gap: 0.75rem;
      margin-left: auto;
    }
    
    @media (max-width: 768px) {
      .action-bar {
        flex-wrap: wrap;
        padding: 1rem;
      }
      
      .search-group {
        order: 1;
        max-width: 100%;
        margin-bottom: 1rem;
      }
      
      .action-btn-group {
        order: 2;
        width: 100%;
        justify-content: flex-end;
      }
      
      .action-btn {
        flex: 1;
        min-width: auto;
        padding: 0.6rem 1rem;
        font-size: 0.85rem;
      }
      
      .action-btn img {
        width: 0.9rem;
        height: 0.9rem;
      }
    }

    /* Form Pages */
    .form-page {
      max-width: 1600px;
      margin: 0 auto;
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      padding: 2.5rem;
    }

    .form-page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1.25rem;
      border-bottom: 1px solid var(--border);
    }

    .form-page-title {
      margin: 0;
      font-size: 1.5rem;
      color: var(--text-primary);
      font-weight: 600;
    }

    /* Question Card */
    .question-card {
      min-height: 260px;
    }

    .question-card .card-header {
      padding: 1.25rem;
    }

    .question-card .card-header-content {
      flex: 1;
      min-width: 0;
    }

    .question-card .card-actions {
      display: flex;
      gap: 0.375rem;
    }

    .question-card .icon-btn {
      padding: 0.375rem;
    }

    .question-card .icon-btn img {
      width: 1rem;
      height: 1rem;
    }

    /* MCQ Options */
    .option-group {
      margin-bottom: 1rem;
      background: var(--bg-primary);
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }

    .option-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem 1rem;
      border-bottom: 1px solid var(--border);
      background: var(--bg-secondary);
    }

    .option-label {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 500;
      color: var(--text-primary);
    }

    .option-radio {
      width: 1.125rem;
      height: 1.125rem;
      border: 2px solid var(--border);
      border-radius: 50%;
      appearance: none;
      position: relative;
      cursor: pointer;
    }

    .option-radio:checked {
      border-color: var(--secondary-dark);
      background: var(--secondary-dark);
    }

    .option-radio:checked::after {
      content: '';
      position: absolute;
      width: 0.375rem;
      height: 0.375rem;
      background: white;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .option-remove {
      padding: 0.25rem;
      background: transparent;
      border: none;
      cursor: pointer;
      opacity: 0.5;
      transition: all var(--transition);
    }

    .option-remove:hover {
      opacity: 1;
      color: var(--error);
    }

    .option-remove img {
      width: 1rem;
      height: 1rem;
    }

    .toast {
      padding: 1rem 1.25rem 1rem 4rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      display: flex;
      align-items: center;
      position: relative;
      overflow: hidden;
      opacity: 0;
      transform: translateX(-100%);
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      border: 1px solid rgba(0, 0, 0, 0.05);
      pointer-events: auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 8px;
      margin: 0;
      max-width: 400px;
      min-width: 300px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-left: 4px solid #3B82F6; /* Default blue border */
    }
    
    .toast.show {
      opacity: 1;
      transform: translateX(0);
      animation: slideIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;
      pointer-events: auto;
    }
    
    @keyframes slideIn {
      from {
        transform: translateX(-100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    .toast.hide {
      opacity: 0;
      transform: translateX(-100%);
      pointer-events: none;
    }
    
    /* Toast Type Colors */
    .toast.success {
      border-left: 4px solid #10B981; /* Green border for success */
    }
    
    .toast.warning {
      border-left: 4px solid #F59E0B; /* Yellow border for warning */
    }
    
    .toast.error {
      border-left: 4px solid #EF4444; /* Red border for error */
    }
    
    .toast.info {
      border-left: 4px solid #3B82F6; /* Blue border for info */
    }
    
    /* Toast Icon Colors */
    .toast.success .icon {
      background-color: #10B981;
    }
    
    .toast.warning .icon {
      background-color: #F59E0B;
    }
    
    .toast.error .icon {
      background-color: #EF4444;
    }
    
    .toast.info .icon {
      background-color: #3B82F6;
    }
    
    .toast .icon {
      position: absolute;
      left: 1.25rem;
      top: 50%;
      transform: translateY(-50%);
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 1.25rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .toast .content {
      flex: 1;
      font-size: 0.95rem;
      line-height: 1.5;
      color: #1F2937; /* Darker text for better readability */
      font-weight: 500;
      padding: 0.5rem 0;
    }
    
    .toast-close {
      background: none;
      border: none;
      font-size: 1.25rem;
      line-height: 1;
      color: #9ca3af;
      cursor: pointer;
      padding: 0.25rem;
      margin-left: 0.5rem;
      opacity: 0.7;
      transition: all 0.2s;
      border-radius: 4px;
      align-self: flex-start;
    }
    
    .toast-close:hover {
      opacity: 1;
      color: #6b7280;
      background: rgba(0, 0, 0, 0.05);
    }
    
    .toast .progress {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 3px;
      background: rgba(0, 0, 0, 0.05);
      width: 100%;
      transform-origin: left;
      overflow: hidden;
    }
    
    .toast .progress::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      height: 100%;
      width: 100%;
      background: var(--primary);
      animation: toastProgress 4s linear forwards;
      transform-origin: left;
    }
    @keyframes toastProgress {
      from { transform: scaleX(1); }
      to { transform: scaleX(0); }
    }

    .toast.info .progress::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      background-color: var(--info);
      transform-origin: left;
      animation: toastProgress 4s linear forwards;
    }
    
    .toast.success .progress::after {
      background-color: var(--success);
    }
    
    .toast.error .progress::after {
      background-color: var(--error);
    }
    
    .toast.warning .progress::after {
      background-color: var(--warning);
    }

    /* Update existing sections */
    #questions .form-group:first-child,
    #modules .form-group:first-child {
      margin-bottom: 0;
      /* Ensure consistent spacing */
      margin-top: 0.5rem;
      /* Prevent margin collapse */
      display: flow-root;
    }

    #question-edit,
    #module-edit {
      max-width: 1600px;
      margin: 0 auto;
      padding: 2.5rem;
    }

    /* Enhanced Search Input */
    /* ===== Modern Page Header ===== */
    .page-header {
      margin: 0 0 1.75rem 0;
      padding: 1.25rem 1.5rem;
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.04);
      border: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1.5rem;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    .page-header:hover {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
      transform: translateY(-1px);
    }
    
    .header-content {
      flex: 1;
      min-width: 0;
      position: relative;
      padding-right: 1rem;
    }
    
    .header-content::after {
      content: '';
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 1px;
      height: 70%;
      background: var(--border);
      opacity: 0.7;
    }
    
    .header-actions {
      display: flex;
      gap: 0.75rem;
      align-items: center;
      flex-shrink: 0;
    }
    
    .page-header h2 {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0 0 0.25rem 0;
      line-height: 1.3;
      letter-spacing: -0.01em;
      background: linear-gradient(90deg, var(--text-primary) 0%, var(--text-secondary) 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      display: inline-block;
    }
    
    .page-subtitle {
      color: var(--text-secondary);
      margin: 0;
      font-size: 0.95rem;
      line-height: 1.5;
      opacity: 0.9;
      max-width: 80%;
    }
    
    .page-header h2 {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
      line-height: 1.2;
    }
    
    .page-subtitle {
      color: var(--text-secondary);
      margin: 0.25rem 0 0 0;
      font-size: 0.9rem;
      line-height: 1.4;
    }
    
    /* ===== Search Row ===== */
    .search-row {
      display: flex;
      gap: 1rem;
      margin: 0 0 1.5rem 0;
      width: 100%;
      flex-wrap: wrap;
    }
    
    .search-group.search-bar {
      flex: 1;
      min-width: 280px;
    }
    
    /* ===== Modern Search Bar ===== */
    .search-group.search-bar {
      position: relative;
      display: flex;
      align-items: center;
      height: 44px;
      background: var(--bg-primary);
      border-radius: 8px;
      border: 1px solid var(--border);
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      padding-left: 2rem;
    }
    
    .search-group.search-bar.tag-search {
      max-width: 320px;
    }
    
    .search-group.search-bar.content-search {
      flex: 2;
      min-width: 280px;
    }
    
    .search-group.search-bar:focus-within {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(var(--primary), 0.2);
    }
    
    .search-group .search-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      color: var(--text-secondary);
      flex-shrink: 0;
      transition: color 0.2s ease;
    }
    
    .search-group.search-bar:focus-within .search-icon {
      color: var(--primary);
    }
    
    .search-group .search-icon img {
      width: 18px;
      height: 18px;
      display: block;
      opacity: 0.8;
      transition: opacity 0.2s ease;
    }
    
    .search-group .search-input {
      width: 100%;
      height: 100%;
      border: none;
      background: transparent;
      padding: 0 1rem 0 0.5rem;
      font-size: 0.95rem;
      font-weight: 450;
      color: var(--text-primary);
      letter-spacing: 0.01em;
      transition: all 0.2s ease;
      margin: 0;
      line-height: 1.5;
    }
    
    .search-group .search-input::placeholder {
      color: var(--text-secondary);
      opacity: 0.8;
      font-weight: 400;
    }
    
    .search-group .search-input:focus {
      outline: none;
      box-shadow: none;
    }
    
    .search-group .search-input::placeholder {
      color: var(--text-tertiary);
      font-weight: 400;
      opacity: 0.8;
      transition: all 0.2s ease;
    }
    
    .search-group .search-input:focus::placeholder {
      opacity: 0.5;
      transform: translateX(4px);
    }
    
    /* ===== Modern Action Buttons ===== */
    .header-actions {
      display: flex;
      gap: 0.75rem;
    }
    
    .action-buttons {
      display: flex;
      gap: 0.75rem;
      height: 100%;
    }
    
    .action-btn {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0 1.1rem;
      height: 40px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1.5px solid transparent;
      white-space: nowrap;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }
    
    .action-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: currentColor;
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
    }
    
    .action-btn:hover::before {
      opacity: 0.08;
    }
    
    .action-btn:active {
      transform: translateY(1px);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }
    
    .action-btn img {
      width: 15px;
      height: 15px;
      opacity: 0.9;
      transition: all 0.2s ease;
    }
    
    .action-btn.primary {
      background: var(--primary);
      color: white;
      border-color: var(--primary-dark);
      box-shadow: 0 2px 8px rgba(var(--primary-rgb), 0.2);
    }
    
    .action-btn.primary:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(var(--primary-rgb), 0.25);
    }
    
    .action-btn.primary:active {
      transform: translateY(0);
      box-shadow: 0 2px 6px rgba(var(--primary-rgb), 0.2);
    }
    
    .action-btn.secondary {
      background: var(--bg-primary);
      border: 1.5px solid var(--border);
      color: var(--text-primary);
      transition: all 0.2s ease, border-color 0.2s ease;
    }
    
    .action-btn.secondary:hover {
      background: var(--bg-secondary);
      border-color: var(--border-dark);
      transform: translateY(-1px);
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
    }
    
    .action-btn.secondary:active {
      transform: translateY(0);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03);
    }
    
    /* Responsive Adjustments */
    /* ===== Responsive Design ===== */
    @media (max-width: 1200px) {
      .search-group.search-bar.tag-search,
      .search-group.search-bar.content-search {
        max-width: 100%;
        flex: 1 1 100%;
      }
    }
    
    @media (max-width: 992px) {
      .page-header {
        flex-direction: column;
        align-items: stretch;
        gap: 1.25rem;
        padding: 1.5rem;
      }
      
      .header-content {
        padding-right: 0;
        padding-bottom: 1rem;
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
      
      .header-content::after {
        display: none;
      }
      
      .header-actions {
        width: 100%;
        margin-top: 0.25rem;
      }
      
      .search-container {
        flex-direction: column;
        gap: 1rem;
        margin-bottom: 1.75rem;
      }
      
      .search-container .search-row {
        gap: 0.75rem;
        margin-bottom: 1.5rem;
      }
      
      .search-group.search-bar {
        width: 100%;
        height: 44px;
      }
      
      .action-buttons {
        width: 100%;
      }
      
      .action-btn {
        flex: 1;
        height: 44px;
        padding: 0 1rem;
      }
      
      .page-subtitle {
        max-width: 100%;
      }
    }
    
    @media (max-width: 576px) {
      .page-header {
        padding: 1.25rem 1rem;
        gap: 1rem;
      }
      
      .header-actions {
        flex-wrap: wrap;
      }
      
      .action-btn {
        font-size: 0.85rem;
        padding: 0 0.75rem;
      }
      
      .search-group .search-input {
        font-size: 0.9rem;
      }
    }
    
    .search-group {
      position: relative;
      display: flex;
      align-items: center;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto 1.5rem auto;
    }

    .search-group input.form-control {
      width: 100%;
      padding-left: 3.5rem;
      padding-right: 1.5rem;
      border-radius: 2rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      border: 2px solid var(--border);
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .search-group input.form-control:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(var(--primary), 0.1);
    }

    .search-group .search-icon {
      position: absolute;
      left: 1.1rem;
      top: 50%;
      transform: translateY(-50%);
      width: 1.3rem;
      height: 1.3rem;
      opacity: 0.7;
      pointer-events: none;
    }

    /* Add Roboto Slab as default font */
    @font-face {
      font-family: 'Roboto Slab';
      src: url('Roboto_Slab.ttf') format('truetype');
    }

    /* Module Question Selection */
    #module-question-select {
      margin-top: 1.5rem;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(600px, 1fr));
      gap: 1.5rem;
    }

    #module-question-select .card {
      position: relative;
      padding: 1.5rem;
      cursor: pointer;
      transition: all var(--transition);
    }

    #module-question-select .card:hover {
      /* transform: translateY(-2px); Removed hover animation */
      /* border-color: var(--primary-light); Removed hover animation */
      z-index: 1;
    }

    #module-question-select .card label {
      display: flex;
      gap: 1rem;
      align-items: flex-start;
      cursor: pointer;
    }

    #module-question-select .card input[type="checkbox"] {
      width: 1.25rem;
      height: 1.25rem;
      margin-top: 0.25rem;
    }

    #module-question-select .card .question-text {
      flex: 1;
      min-width: 0;
    }

    #module-question-select .card .expand-btn {
      position: absolute;
      right: 1rem;
      top: 1rem;
    }

    #module-question-select .card .answer-section {
      display: none;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
    }

    #module-question-select .card.expanded .answer-section {
      display: block;
    }

    /* Module Card Home - Enhanced Design */
    .module-card-home {
      min-height: 220px;
      padding: 0;
      display: flex;
      flex-direction: column;
      border-radius: 16px;
      overflow: hidden;
      background: var(--bg-primary);
      border: 1px solid var(--border);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .module-card-home:hover {
      /* Remove zoom/scale/transform on hover */
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      /* transform: translateY(-4px); */
    }

    .module-card-content {
      padding: 1.75rem 2rem;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .module-card-home .card-header {
      padding: 0;
      margin-bottom: 1.5rem;
      border: none;
      position: relative;
    }

    .module-card-badge {
      position: absolute;
      top: -10px;
      right: 0;
      background: var(--primary-light);
      color: var(--primary-dark);
      font-size: 0.8rem;
      font-weight: 600;
      padding: 0.35rem 0.9rem;
      border-radius: 50px;
      box-shadow: 0 2px 8px rgba(255,112,67,0.15);
    }

    .module-card-home .card-title {
      font-size: 1.5rem;
      margin: 0.5rem 0 0.75rem;
      color: var(--text-primary);
      font-weight: 700;
      line-height: 1.3;
    }

    .module-card-home .card-desc {
      color: var(--text-secondary);
      font-size: 0.95rem;
      line-height: 1.5;
      margin: 0;
    }

    .module-card-home .progress-section {
      margin-top: auto;
    }

    .module-card-home .progress-item {
      margin-bottom: 1.25rem;
    }

    .module-card-home .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .module-card-home .progress {
      height: 8px;
      background: #f0f0f0;
      border-radius: 4px;
      overflow: hidden;
    }

    .module-card-home .progress-bar {
      height: 100%;
      background: var(--primary);
      border-radius: 4px;
      transition: width 0.6s ease;
    }

    .module-card-home .accuracy-bar {
      background: #4caf50;
    }

    .module-card-home .progress-percent {
      font-weight: 600;
      color: var(--text-primary);
    }

    .module-card-home .card-actions {
      margin: 0;
      padding: 1.25rem 2rem;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border);
    }

    .module-card-home .start-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      width: 100%;
      padding: 0.85rem 1.5rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .module-card-home .start-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(255,112,67,0.25);
    }

    .module-card-home .start-btn:active {
      transform: translateY(0);
    }

    .module-card-home .start-btn img {
      width: 18px;
      height: 18px;
      filter: brightness(0) invert(1);
    }

    .module-card-home .progress-section {
      margin: 1.25rem 0;
    }

    .module-card-home .progress-item {
      margin-bottom: 1rem;
    }

    .module-card-home .progress-item:last-child {
      margin-bottom: 0;
    }

    .module-card-home .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.875rem;
      color: var(--text-secondary);
    }

    .module-card-home .progress {
      height: 0.5rem;
      background: var(--bg-secondary);
      border-radius: 9999px;
      overflow: hidden;
    }

    .module-card-home .progress-bar {
      height: 100%;
      background: var(--primary);
      border-radius: 9999px;
      transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .module-card-home .card-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 1.5rem;
    }

    .module-card-home .start-btn {
      min-width: 120px;
    }

    /* Quiz Page */
    .quiz-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .quiz-question {
      background: var(--bg-primary);
      padding: 2rem;
      border-radius: var(--radius-lg);
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      font-weight: 500;
    }

    .answer-input {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .answer-input .form-control {
      flex: 1;
    }

    .quiz-options {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .quiz-options button {
      width: 100%;
      text-align: left;
      padding: 1.25rem;
      background: var(--bg-secondary);
      border: 2px solid var(--border);
      border-radius: var(--radius);
      font-size: 1.1rem;
      transition: all var(--transition);
    }

    .quiz-options button:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    .feedback {
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      margin-top: 2rem;
      overflow: hidden;
    }

    .feedback-content {
      padding: 2rem;
    }

    .feedback.correct .feedback-header {
      color: var(--success);
    }

    .feedback.incorrect .feedback-header {
      color: var(--error);
    }

    .feedback-header {
      font-size: 1.25rem;
      margin-bottom: 1rem;
    }

    .feedback-body {
      color: var(--text-secondary);
      font-size: 1.2rem;
      line-height: 1.8;
    }

    .feedback .next-btn {
      width: 100%;
      padding: 1rem;
      border-radius: 0;
      margin-top: 1rem;
      justify-content: center;
    }

    .completion-message {
      text-align: center;
      padding: 3rem 2rem;
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }

    .completion-message h3 {
      color: var(--success);
      margin-bottom: 1rem;
    }

    .completion-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
    }

    /* Question Card Improvements */
    .question-card .summary img {
      display: none;
    }

    .question-card.expanded .full-text img {
      max-width: 100%;
      height: auto;
      margin: 1rem 0;
    }

    .question-card .card-body {
      padding: 1.5rem;
    }

    .question-card .card-body ul,
    .question-card .card-body ol {
      padding-left: 1.5rem;
      margin: 1rem 0;
    }

    .question-card .card-body li {
      margin-bottom: 0.5rem;
    }

    /* MCQ Options in Question Card */
    .question-card .card-body .correct {
      color: var(--success);
      background: #ebfbee;
      padding: 0.75rem 1rem;
      border-radius: var(--radius);
      border: 1px solid #8ce99a;
    }

    /* 2. Card and container design improvements */
    .card, .modal, .form-page, .quiz-container {
      border-radius: var(--radius-lg);
      box-shadow: var(--card-shadow);
      border: 1.5px solid var(--border);
      background: var(--card-bg);
      transition: box-shadow var(--transition), border-color var(--transition), background var(--transition), transform var(--transition);
    }
    .card:hover, .modal:hover, .form-page:hover, .quiz-container:hover {
      box-shadow: var(--card-shadow-hover);
      border-color: var(--primary-light);
      background: var(--card-hover);
      /* transform: translateY(-2px) scale(1.01); */
    }

    /* 3. Math Font button visually distinct when active */
    .rich-toolbar button.active[data-cmd='mathFont'] {
      background: var(--secondary);
      border-color: var(--primary);
      color: #fff;
      box-shadow: 0 2px 8px rgba(255,112,67,0.15);
    }
    .rich-toolbar button[data-cmd='mathFont'] img {
      filter: none;
      opacity: 1;
    }
    .rich-toolbar button.active[data-cmd='mathFont'] img {
      filter: brightness(0) invert(1);
    }

    /* 4. Ensure font classes are preserved in cards, containers, and modals */
    .card .math-font, .modal .math-font, .form-page .math-font, .quiz-container .math-font {
      font-family: 'Math Font', serif !important;
    }

    /* Fun Loading Spinners */
    .spinner {
      display: inline-block;
      width: 2.5rem;
      height: 2.5rem;
      margin: 2rem auto;
      position: relative;
    }
    
    /* Random spinner selection */
    .spinner::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      animation: var(--spinner-animation, spin 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite);
      border: 3px solid transparent;
      border-top-color: var(--primary);
      border-right-color: var(--primary-dark);
      border-bottom-color: var(--primary-light);
    }
    
    /* Bouncing Dots */
    .spinner.dots::before {
      content: '';
      width: 12px;
      height: 12px;
      background: var(--primary);
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out both;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }
    
    .spinner.dots::after {
      content: '';
      width: 12px;
      height: 12px;
      background: var(--primary-light);
      border-radius: 50%;
      position: absolute;
      left: 30%;
      animation: bounce 1.4s infinite -0.2s ease-in-out both;
    }
    
    .spinner.dots span {
      content: '';
      width: 12px;
      height: 12px;
      background: var(--primary-dark);
      border-radius: 50%;
      position: absolute;
      right: 30%;
      animation: bounce 1.4s infinite -0.4s ease-in-out both;
    }
    
    /* Orbit Spinner */
    .spinner.orbit::before {
      border: 2px solid rgba(0,0,0,0.1);
      border-left-color: var(--primary);
      animation: orbit 1.1s infinite linear;
    }
    
    /* Pulse Spinner */
    .spinner.pulse {
      background: var(--primary-light);
      border-radius: 50%;
      animation: pulse 1.5s infinite ease-in-out;
    }
    
    .spinner.pulse::before {
      display: none;
    }
    
    /* Keyframes */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); } 
      40% { transform: scale(1); }
    }
    
    @keyframes orbit {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes pulse {
      0% { transform: scale(0.8); opacity: 0.7; }
      50% { transform: scale(1.2); opacity: 1; }
      100% { transform: scale(0.8); opacity: 0.7; }
    }
    
    /* Random spinner class assignment */
    .spinner[data-random] {
      --spinner-animation: none;
    }
    
    .spinner[data-random]::before {
      animation: none;
    }
    
    /* Loading text */
    .loading-text {
      text-align: center;
      margin-top: 1rem;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    /* MCQ answer design in cards/modals */
    .card .quiz-options button.correct, .modal .quiz-options button.correct {
      background: #e6f9ec;
      border: 2px solid #2e7d32;
      color: #2e7d32;
      font-weight: 600;
      position: relative;
    }
    
    /* Explanation box styling */
    .explanation-box {
      background: #f5f5f5;
      border-left: 4px solid #3f51b5;
      padding: 1.75rem 2.25rem;
      margin: 2.25rem 0;
      border-radius: var(--radius);
      font-size: 1.2rem;
      line-height: 1.8;
      max-width: 1000px;
      width: 90%;
      margin-left: auto;
      margin-right: auto;
      box-shadow: var(--shadow-sm);
      transition: transform var(--transition-fast) ease-out, 
                  box-shadow var(--transition-fast) ease-out;
      will-change: transform, box-shadow;
      backface-visibility: hidden;
      -webkit-font-smoothing: subpixel-antialiased;
    }
    
    .explanation-box:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow);
    }
    
    .explanation-box strong {
      color: #3f51b5;
      margin-bottom: 0.5rem;
      display: block;
    }
    .card .quiz-options button.correct::before, .modal .quiz-options button.correct::before {
      content: '✓';
      color: #2e7d32;
      font-size: 1.1rem;
      margin-right: 0.5rem;
    }
    .card .quiz-options button.incorrect, .modal .quiz-options button.incorrect {
      background: #fff5f5;
      border: 2px solid #d32f2f;
      color: #d32f2f;
      font-weight: 600;
      position: relative;
    }
    .card .quiz-options button.incorrect::before, .modal .quiz-options button.incorrect::before {
      content: '✗';
      color: #d32f2f;
      font-size: 1.1rem;
      margin-right: 0.5rem;
    }

    /* Compact quiz answer input */
    #typed-answer.form-control {
      min-height: 2.2rem;
      padding: 0.5rem 1rem;
      font-size: 1.05rem;
      line-height: 1.3;
      resize: none;
      border-radius: 8px;
      margin-bottom: 0;
    }

    /* MCQ options in cards: improve spacing */
    .quiz-options {
      gap: 0.5rem;
    }
    .quiz-options button {
      border-radius: 8px;
      transition: box-shadow 0.2s, border-color 0.2s;
    }
    .quiz-options button:hover {
      box-shadow: 0 2px 8px rgba(255,112,67,0.10);
      border-color: var(--primary);
    }

    /* Module status badge */
    .badge.locked {
      background: #fbe9e7;
      color: #d32f2f;
      font-weight: 600;
      font-size: 0.95rem;
      padding: 0.3em 0.9em;
    }
    .badge.unlocked {
      background: #e6f9ec;
      color: #2e7d32;
      font-weight: 600;
      font-size: 0.95rem;
      padding: 0.3em 0.9em;
    }
    .module-status {
      margin-left: 0.5rem;
      vertical-align: middle;
    }

    /* Smaller icons in module card actions */
    .card .card-actions .icon-btn img {
      width: 1.1rem;
      height: 1.1rem;
    }
    .card .card-actions {
      gap: 0.5rem;
      align-items: center;
    }

    /* Import Comparison Modal */
    #import-comparison-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      overflow: auto;
    }

    .import-comparison {
      background-color: #fefefe;
      margin: 5% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 900px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      max-height: 80vh;
      display: flex;
      flex-direction: column;
    }

    .import-comparison .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
      margin-bottom: 15px;
    }

    .import-comparison .modal-body {
      flex: 1;
      overflow-y: auto;
      padding: 10px 0;
    }

    .import-comparison .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      padding-top: 15px;
      border-top: 1px solid #eee;
      margin-top: 15px;
    }

    .import-summary {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 6px;
    }

    .summary-item {
      text-align: center;
      padding: 0 15px;
    }

    .summary-count {
      display: block;
      font-size: 24px;
      font-weight: bold;
      color: #333;
    }

    .summary-label {
      font-size: 14px;
      color: #666;
    }

    .import-tabs {
      display: flex;
      border-bottom: 1px solid #ddd;
      margin-bottom: 15px;
    }

    .tab-btn {
      padding: 8px 16px;
      background: none;
      border: none;
      border-bottom: 2px solid transparent;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: #666;
      transition: all 0.2s;
    }

    .tab-btn:hover {
      color: #333;
    }

    .tab-btn.active {
      color: #007bff;
      border-bottom-color: #007bff;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .import-section {
      margin-bottom: 25px;
    }

    .import-section h4 {
      margin: 15px 0 10px;
      color: #444;
      font-size: 16px;
      font-weight: 500;
    }

    .import-item {
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      margin-bottom: 10px;
      overflow: hidden;
      background-color: #fff;
      transition: box-shadow 0.2s;
    }

    .import-item:hover {
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .import-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 15px;
      background-color: #f9f9f9;
      border-bottom: 1px solid #eee;
    }

    .import-item-title {
      margin: 0;
      font-size: 14px;
      font-weight: 500;
      color: #333;
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .import-item-actions {
      display: flex;
      gap: 8px;
    }

    .import-item-btn {
      padding: 4px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: #fff;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .import-item-btn.keep {
      color: #28a745;
      border-color: #28a745;
    }

    .import-item-btn.discard {
      color: #dc3545;
      border-color: #dc3545;
    }

    .import-item-btn.active {
      color: white;
    }

    .import-item-btn.keep.active {
      background-color: #28a745;
    }

    .import-item-btn.discard.active {
      background-color: #dc3545;
    }

    .import-item-preview {
      padding: 10px 15px;
      font-size: 13px;
      color: #666;
      background-color: #fff;
    }

    .import-item-diff {
      padding: 10px 15px;
      font-size: 13px;
      background-color: #fff;
    }

    .diff-container {
      font-size: 13px;
    }

    .diff-row {
      display: flex;
      margin-bottom: 8px;
    }

    .diff-label {
      width: 100px;
      font-weight: 500;
      color: #666;
      flex-shrink: 0;
    }

    .diff-content {
      flex: 1;
    }

    .diff-removed,
    .diff-added {
      padding: 2px 4px;
      border-radius: 3px;
      margin: 2px 0;
      word-break: break-word;
    }

    .diff-removed {
      background-color: #ffebee;
      text-decoration: line-through;
      color: #c62828;
    }

    .diff-added {
      background-color: #e8f5e9;
      color: #2e7d32;
    }

    .empty-state {
      text-align: center;
      padding: 20px;
      color: #999;
      font-style: italic;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .import-comparison {
        width: 95%;
        margin: 10px auto;
        padding: 10px;
      }

      .import-summary {
        flex-direction: column;
        gap: 15px;
      }

      .summary-item {
        padding: 5px 0;
      }

      .import-item-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }

      .import-item-title {
        white-space: normal;
      }

      .diff-row {
        flex-direction: column;
        gap: 5px;
      }

      .diff-label {
        width: 100%;
      }
    }

    /* Add to the CSS in <style> in index.html */
    .quiz-options button,
    .card .icon-btn,
    .btn,
    .action-btn {
      font-family: var(--font-serif);
    }

    /* Ensure .math-font always overrides to Math Font */
    .math-font, .math-font * {
      font-family: var(--font-math);
    }

    /* Module Review Styles */
    .quiz-container {
      max-width: 95%;
      width: 100%;
      margin: 0 auto;
      padding: 2rem;
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .review-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border);
    }

    .review-title {
      font-size: 1.75rem;
      color: var(--text-primary);
      margin: 0;
    }

    .review-question {
      background: var(--bg-secondary);
      border-radius: var(--radius);
      padding: 2rem;
      margin-bottom: 1.5rem;
    }

    .review-question-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .question-number {
      font-weight: 600;
      color: var(--text-secondary);
    }

    .question-status {
      padding: 0.5rem 1rem;
      border-radius: var(--radius-sm);
      font-weight: 600;
    }

    .question-status.correct {
      background: #e6f9ec;
      color: #2e7d32;
    }

    .review-question-content {
      margin-bottom: 1.5rem;
    }

    .answer-comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
    }

    .answer-section {
      padding: 1rem;
      border-radius: var(--radius-sm);
    }

    .answer-section h4 {
      font-size: 1rem;
      margin-bottom: 0.75rem;
      color: var(--text-secondary);
    }

    .correct-answer {
      background: #f0fdf4;
      border: 1px solid #86efac;
    }

    .user-answer {
      background: #fafafa;
      border: 1px solid var(--border);
    }

    /* MCQ Review Specific Styles */
    .review-mcq-options {
      display: grid;
      gap: 0.75rem;
      margin-top: 1rem;
    }

    .review-mcq-option {
      padding: 1rem;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      background: var(--bg-primary);
    }

    .review-mcq-option.correct {
      background: #f0fdf4;
      border-color: #86efac;
      color: #2e7d32;
    }

    /* --- KaTeX Equation Block Styles --- */
    .katex-equation {
      display: inline-block;
      background: #fff3e0;
      border: 1.5px solid #ffab91;
      border-radius: 8px;
      padding: 0.35em 0.8em 0.35em 0.8em;
      margin: 0 0.15em;
      min-width: 2.2em;
      min-height: 2.2em;
      vertical-align: middle;
      position: relative;
      transition: box-shadow 0.18s;
      box-shadow: 0 2px 8px rgba(255,112,67,0.07);
    }
    .katex-equation .katex-toolbar {
      gap: 0.2em;
      background: #fff8f3;
      border-radius: 6px;
      box-shadow: 0 2px 8px rgba(255,112,67,0.10);
      padding: 0.1em 0.2em;
      border: 1px solid #ffd6c2;
      display: none;
      align-items: center;
      position: absolute;
      top: 2px;
      right: 2px;
      z-index: 2;
    }
    .katex-equation:hover .katex-toolbar {
      display: flex !important;
    }
    .katex-equation .katex-toolbar button {
      background: none;
      border: none;
      padding: 0.1em;
      border-radius: 4px;
      cursor: pointer;
      opacity: 0.8;
      transition: background 0.15s;
    }
    .katex-equation .katex-toolbar button:hover {
      background: #ffe0b2;
      opacity: 1;
    }
    .katex-equation .katex-render {
      display: inline-block;
      vertical-align: middle;
    }

    /* KaTeX Equation Modal Styles */
    .equation-modal {
      max-width: 700px;
      margin: 0 auto;
      border-radius: 18px;
      box-shadow: 0 10px 32px rgba(255,112,67,0.13), 0 2px 10px rgba(0,0,0,0.04);
      border: 1.5px solid var(--primary-light);
      background: var(--bg-primary);
      padding: 0;
    }
    .equation-modal-body {
      padding: 2.5rem 2rem 2rem 2rem;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      min-width: 420px;
      max-width: 700px;
    }
    .equation-modal-title {
      font-size: 1.35rem;
      font-weight: 700;
      color: var(--primary-dark);
      margin-bottom: 0.5rem;
      text-align: left;
    }
    .equation-modal-label {
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 0.25rem;
    }
    .equation-modal-input {
      font-size: 1.2rem;
      padding: 0.8em 1em;
      border-radius: 10px;
      border: 2px solid var(--border);
      background: #fff;
      margin-bottom: 0.5rem;
      min-height: 80px;
      max-width: 100%;
      resize: vertical;
    }
    .equation-modal-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255,112,67,0.10);
    }
    .equation-modal-preview-label {
      font-size: 0.97rem;
      color: var(--text-secondary);
      margin-bottom: 0.25rem;
    }
    .equation-modal-preview {
      min-height: 3em;
      background: #fff8f3;
      border: 2px solid var(--primary-light);
      border-radius: 12px;
      padding: 1em 1.5em;
      margin-bottom: 0.5rem;
      font-size: 1.4em;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      min-width: 2.5em;
      max-width: 100%;
      overflow-x: auto;
    }
    .equation-modal-actions {
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
      margin-top: 1.2rem;
    }
    .rich-toolbar#katex-toolbar {
      flex-wrap: wrap;
      gap: 0.5rem 1.2rem;
      justify-content: flex-start;
      margin-bottom: 0;
      max-width: 100%;
    }
    @media (max-width: 900px) {
      .equation-modal, .equation-modal-body {
        max-width: 98vw;
        min-width: 0;
        padding: 1.2rem 0.7rem 1rem 0.7rem;
      }
      .equation-modal-preview, .equation-modal-input {
        font-size: 1.1em;
        padding: 0.7em 0.7em;
      }
    }

    /* --- Enhanced Breadcrumb Styles --- */
    #breadcrumb {
      font-family: var(--font-sans);
      font-size: 0.95rem;
      color: var(--text-secondary);
      margin: 0 0 1.5rem 0;
      padding: 0.75rem 1.5rem;
      background: var(--bg-secondary);
      border-radius: var(--radius);
      box-shadow: var(--shadow-sm);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
    }
    
    #breadcrumb a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s ease;
      display: inline-flex;
      align-items: center;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
    }
    
    #breadcrumb a:hover {
      color: var(--primary-dark);
      background: rgba(32, 178, 170, 0.1);
    }
    
    .breadcrumb-separator {
      color: var(--text-secondary);
      opacity: 0.4;
      margin: 0 0.25rem;
      font-size: 0.9em;
      display: inline-flex;
      align-items: center;
    }
    
    #breadcrumb .current {
      color: var(--text-primary);
      font-weight: 600;
      padding: 0.25rem 0.5rem;
      background: rgba(32, 178, 170, 0.1);
      border-radius: 4px;
    }
    
    #breadcrumb .tag {
      background: var(--primary-light);
      color: white;
      padding: 0.15rem 0.6rem;
      border-radius: 12px;
      font-size: 0.85em;
      margin-left: 0.5rem;
      font-weight: 500;
    }

    /* Explanation Box */
    .explanation-box {
      background: #fff3e0;
      border: 2px solid #ffab91;
      border-radius: 12px;
      padding: 1.25rem 1.5rem;
      margin-top: 1.25rem;
      margin-bottom: 1.25rem;
      color: var(--text-primary);
      font-size: 1.05rem;
      box-shadow: 0 2px 8px rgba(255,112,67,0.07);
      font-family: var(--font-serif);
    }

    /* Table Styles */
    .rich-text-editor table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      table-layout: fixed;
    }
    
    .rich-text-editor table, 
    .rich-text-editor th, 
    .rich-text-editor td {
      border: 1px solid var(--border);
      min-width: 60px;
    }
    
    .rich-text-editor th, 
    .rich-text-editor td {
      padding: 0.5rem;
      text-align: left;
      vertical-align: top;
      position: relative;
    }
    
    .rich-text-editor th {
      background-color: var(--bg-secondary);
      font-weight: 600;
    }
    
    .rich-text-editor table.bordered {
      border: 2px solid var(--border);
    }
    
    .rich-text-editor table.bordered th,
    .rich-text-editor table.bordered td {
      border: 1px solid var(--border);
    }
    
    .rich-text-editor table.striped tbody tr:nth-child(even) {
      background-color: var(--bg-secondary);
    }
    
    .rich-text-editor table.hover tbody tr:hover {
      background-color: rgba(var(--primary-rgb), 0.08);
    }
    
    .table-controls {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--primary);
      border-radius: 4px;
      padding: 2px 4px;
      display: flex;
      gap: 4px;
      opacity: 0;
      transition: opacity 0.2s;
      z-index: 10;
    }
    
    .rich-text-editor table:hover .table-controls {
      opacity: 1;
    }
    
    .table-control-btn {
      background: white;
      border: none;
      border-radius: 2px;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 12px;
      padding: 0;
    }
    
    .table-control-btn:hover {
      background: #f0f0f0;
    }
    
    /* Style for table button in toolbar */
    .rich-toolbar .insert-table-btn {
      display: inline-flex !important;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      padding: 6px;
      margin: 2px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: white;
      cursor: pointer;
      opacity: 1 !important;
      visibility: visible !important;
      transition: all 0.2s ease;
    }
    
    .rich-toolbar .insert-table-btn:hover {
      background: var(--bg-secondary);
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .rich-toolbar .insert-table-btn img {
      width: 20px;
      height: 20px;
      object-fit: contain;
      display: block;
    }
    
    /* Ensure the toolbar buttons are visible */
    .rich-toolbar {
      display: flex !important;
      flex-wrap: wrap;
      gap: 4px;
      padding: 4px;
      background: #f8f9fa;
      border: 2px solid red !important; /* Debug border */
      border-radius: 8px 8px 0 0;
      position: relative;
      z-index: 1000;
    }
    
    .rich-toolbar button {
      opacity: 1 !important;
      visibility: visible !important;
      position: relative;
      z-index: 1;
      display: inline-flex !important;
      align-items: center;
      justify-content: center;
      min-width: 36px;
      height: 36px;
      padding: 6px;
      margin: 2px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: white;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .rich-toolbar button img {
      width: 20px;
      height: 20px;
      object-fit: contain;
      display: block;
    }
    /* Table styles */
    .rich-table {
      border-collapse: collapse;
      margin: 10px 0;
      width: 100%;
      border: 1px solid #ddd;
    }
    
    .rich-table td {
      border: 1px solid #ddd;
      padding: 8px;
      min-width: 100px;
      min-height: 40px;
      vertical-align: top;
      position: relative;
    }
    
    .rich-table td:focus {
      outline: 2px solid #4CAF50;
      outline-offset: -1px;
    }
    
    .table-controls {
      position: absolute;
      top: -35px;
      left: 0;
      background: #4a5568;
      border: 1px solid #2d3748;
      border-radius: 4px;
      padding: 4px;
      display: none;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      transition: all 0.2s ease;
    }
    
    .table-controls:before {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 10px;
      width: 10px;
      height: 10px;
      background: #4a5568;
      transform: rotate(45deg);
      border-right: 1px solid #2d3748;
      border-bottom: 1px solid #2d3748;
    }
    
    .table-controls button {
      background: transparent;
      border: none;
      color: white;
      border-radius: 3px;
      margin: 0 1px;
      padding: 4px 8px;
      cursor: pointer;
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }
    
    .table-controls button:hover {
      background: #2d3748;
    }
    
    .table-controls button[data-action="add-row"]:before {
      content: '⤵';
      margin-right: 4px;
    }
    
    .table-controls button[data-action="add-col"]:before {
      content: '⤵';
      margin-right: 4px;
      transform: rotate(90deg);
      display: inline-block;
    }
    
    .table-controls button[data-action="delete-row"]:before {
      content: '−';
      margin-right: 4px;
    }
    
    .table-controls button[data-action="delete-col"]:before {
      content: '−';
      margin-right: 4px;
      transform: rotate(90deg);
      display: inline-block;
    }
    
    .table-insert-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }
    
    .table-insert-dialog {
      background: white;
      padding: 20px;
      border-radius: 8px;
      width: 300px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    .table-insert-dialog h3 {
      margin-top: 0;
      margin-bottom: 15px;
    }
    
    .table-size-inputs {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .table-size-input {
      flex: 1;
    }
    
    .table-size-input label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    .table-size-input input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    .table-insert-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
    }
    
    .table-insert-actions button {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
    
    .table-insert-actions .cancel-btn {
      background: #f0f0f0;
    }
    
    .table-insert-actions .insert-btn {
      background: #4CAF50;
      color: white;
    }
    
    .table-insert-actions .insert-btn:hover {
      background: #45a049;
    }
    
    .table-insert-actions .cancel-btn:hover {
      background: #e0e0e0;
    }
    
    /* Empty State Styles */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 3rem 1.5rem;
      color: #666;
      max-width: 500px;
      margin: 0 auto;
      animation: fadeIn 0.3s ease;
    }
    
    .empty-state-icon {
      color: var(--primary);
      margin-bottom: 1.5rem;
      opacity: 0.8;
    }

    /* Settings Page Styles */
    .setting-actions {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    
    .setting-hint {
      display: flex;
      align-items: flex-start;
      gap: 0.5rem;
      color: var(--text-secondary);
      font-size: 0.875rem;
      line-height: 1.5;
      background: var(--bg-secondary);
      padding: 0.75rem 1rem;
      border-radius: 6px;
      margin: 1rem 0 0;
    }
    
    .setting-hint .info-icon {
      width: 1rem;
      height: 1rem;
      margin-top: 0.2rem;
      flex-shrink: 0;
    }
    
    .card {
      background: var(--bg-primary);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      border: 1px solid var(--border);
    }
    
    .card h3 {
      margin-top: 0;
      margin-bottom: 1.25rem;
      font-size: 1.125rem;
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .form-group {
      margin-bottom: 1.25rem;
    }
    
    .form-group:last-child {
      margin-bottom: 0;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--text-primary);
    }
    
    .empty-state h3 {
      color: #333;
      margin: 0 0 0.75rem;
      font-size: 1.5rem;
      font-weight: 600;
    }
    
    .empty-state p {
      margin: 0 0 1.5rem;
      line-height: 1.6;
      color: #666;
    }
    
    .empty-state-actions {
      margin-top: 1rem;
    }
    
    .empty-state-actions .btn-outline {
      border: 1px solid var(--primary);
      color: var(--primary);
      background: transparent;
      padding: 0.5rem 1.25rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }
    
    .empty-state-actions .btn-outline:hover {
      background: rgba(255, 112, 67, 0.1);
      transform: translateY(-1px);
    }
    
    /* Import Comparison Modal Styles */
    .import-comparison {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-md);
      transition: all var(--transition);
    }
    
    .import-comparison .modal-header {
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .import-comparison .modal-header h3 {
      margin: 0;
      color: var(--text-primary);
      font-size: 1.25rem;
      font-weight: 600;
    }
    
    .import-comparison .close {
      font-size: 1.75rem;
      font-weight: 300;
      color: var(--text-secondary);
      cursor: pointer;
      line-height: 1;
      transition: color var(--transition);
    }
    
    .import-comparison .close:hover {
      color: var(--text-primary);
    }
    
    .import-comparison .modal-body {
      padding: 1.5rem;
      max-height: 60vh;
      overflow-y: auto;
    }
    
    .import-comparison .modal-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: flex-end;
      gap: 0.75rem;
      background: var(--bg-secondary);
      border-bottom-left-radius: var(--radius);
      border-bottom-right-radius: var(--radius);
    }
    
    .import-summary {
      display: flex;
      justify-content: space-around;
      margin: 0 0 1.5rem;
      padding: 1rem;
      background: var(--bg-secondary);
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }
    
    .summary-item {
      text-align: center;
      padding: 0.5rem 1rem;
    }
    
    .summary-count {
      display: block;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.25rem;
    }
    
    .summary-label {
      font-size: 0.875rem;
      color: var(--text-secondary);
    }
    
    .import-tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
      margin: 0 -1.5rem 1.5rem;
      padding: 0 1.5rem;
    }
    
    .tab-btn {
      padding: 0.75rem 1.5rem;
      border: none;
      background: none;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      position: relative;
      transition: color var(--transition);
    }
    
    .tab-btn:hover {
      color: var(--primary);
      background: var(--bg-tertiary);
    }
    
    .tab-btn.active {
      color: var(--primary);
    }
    
    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--primary);
      border-radius: 2px 2px 0 0;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .import-section {
      margin-bottom: 2rem;
    }
    
    .import-section h4 {
      margin: 1.5rem 0 1rem;
      color: var(--text-primary);
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .import-section h4::before {
      content: '';
      display: inline-block;
      width: 6px;
      height: 1.1rem;
      background: var(--primary);
      border-radius: 3px;
    }
    
    .import-items {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    .import-item {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.25rem;
      transition: all var(--transition);
      box-shadow: var(--shadow-sm);
    }
    
    .import-item:hover {
      border-color: var(--primary-light);
      box-shadow: var(--shadow);
      transform: translateY(-2px);
    }
    
    .import-item-header {
      display: flex;
      align-items: center;
      margin-bottom: 0.75rem;
    }
    
    .import-item-title {
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
      flex: 1;
      font-size: 1.05rem;
    }
    
    .import-item-actions {
      display: flex;
      gap: 0.5rem;
    }
    
    .import-item-btn {
      padding: 0.375rem 0.875rem;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--bg-primary);
      color: var(--text-primary);
      cursor: pointer;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
    }
    
    .import-item-btn:hover {
      background: var(--bg-tertiary);
      border-color: var(--primary-light);
      color: var(--primary);
    }
    
    .import-item-btn.primary {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }
    
    .import-item-btn.primary:hover {
      background: var(--primary-dark);
      border-color: var(--primary-dark);
      color: white;
    }
    
    .import-item-content {
      font-size: 0.95rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }
    
    .diff-preview {
      margin-top: 1rem;
      padding: 1rem;
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-family: var(--font-sans);
      white-space: pre-wrap;
      font-size: 0.9rem;
      line-height: 1.6;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .diff-added {
      background: rgba(46, 160, 67, 0.2);
      text-decoration: none;
      color: inherit;
      padding: 0.1em 0.2em;
      border-radius: 2px;
    }
    
    .diff-removed {
      background: rgba(248, 81, 73, 0.2);
      color: var(--error);
      background: rgba(211, 47, 47, 0.1);
      padding: 0.1rem 0.2rem;
      border-radius: 2px;
      text-decoration: line-through;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .feedback-comparison {
      width: 98vw;
      max-width: 1800px;
      margin-left: auto;
      margin-right: auto;
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      box-shadow: var(--card-shadow);
      padding: 2.5rem 2.5rem;
      transition: box-shadow var(--transition), background var(--transition);
    }

    /* Minimal Module Card Home */
    .module-card-home.minimal {
      background: var(--card-bg);
      border: none;
      box-shadow: var(--card-shadow);
      border-radius: var(--radius-lg);
      padding: 0;
      margin-bottom: 2rem;
      display: flex;
      flex-direction: column;
      min-width: 0;
      max-width: 100%;
      transition: box-shadow var(--transition), background var(--transition), transform var(--transition);
    }
    .module-card-home.minimal .module-card-content {
      padding: 2.2rem 2.5rem 1.5rem 2.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .module-card-home.minimal .card-header {
      background: none;
      border: none;
      padding: 0;
      margin-bottom: 1.2rem;
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }
    .module-card-home.minimal .module-card-badge {
      background: var(--primary-pale);
      color: var(--primary-dark);
      font-size: 0.92rem;
      font-weight: 600;
      padding: 0.32rem 0.85rem;
      border-radius: 999px;
      box-shadow: none;
      align-self: flex-end;
      margin-bottom: 0.2rem;
    }
    .module-card-home.minimal .card-title {
      font-size: 1.35rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0.2rem 0 0.3rem 0;
      line-height: 1.2;
    }
    .module-card-home.minimal .card-desc {
      color: var(--text-secondary);
      font-size: 1.02rem;
      margin: 0 0 0.2rem 0;
      line-height: 1.5;
    }
    .module-card-home.minimal .progress-section {
      margin: 1.2rem 0 0.2rem 0;
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
    }
    .module-card-home.minimal .progress-item {
      margin-bottom: 0;
    }
    .module-card-home.minimal .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.3rem;
      font-size: 0.97rem;
      color: var(--text-secondary);
      font-weight: 500;
    }
    .module-card-home.minimal .progress {
      height: 0.6rem;
      background: var(--bg-tertiary);
      border-radius: 9999px;
      overflow: hidden;
      box-shadow: none;
    }
    .module-card-home.minimal .progress-bar {
      height: 100%;
      border-radius: 9999px;
      transition: width 0.7s cubic-bezier(0.4, 0, 0.2, 1), background 0.3s;
    }
    .module-card-home.minimal .progress-bar.completion {
      background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
    }
    .module-card-home.minimal .progress-bar.accuracy {
      background: linear-gradient(90deg, var(--success) 0%, var(--success-light) 100%);
    }
    .module-card-home.minimal .card-actions {
      background: none;
      box-shadow: none;
      padding: 0 2.5rem 2rem 2.5rem;
      margin-top: 0.5rem;
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: flex-end;
    }
    .module-card-home.minimal .start-btn {
      display: block;
      width: 100%;
      font-size: 1.08rem;
      font-weight: 700;
      padding: 1.1rem 0;
      border-radius: 2rem;
      background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
      color: #fff;
      box-shadow: 0 2px 8px rgba(108,99,255,0.08);
      border: none;
      transition: background 0.2s, box-shadow 0.2s, transform 0.15s;
      letter-spacing: 0.01em;
      cursor: pointer;
    }
    .module-card-home.minimal .start-btn:hover {
      background: linear-gradient(90deg, var(--primary-light) 0%, var(--primary) 100%);
      box-shadow: 0 8px 32px rgba(108,99,255,0.13);
      /* transform: translateY(-1.5px) scale(1.01); */
    }
    /* Ensure no horizontal scroll in card lists or review */
    .card-list, #review-questions, .quiz-container, .feedback-comparison {
      overflow-x: hidden !important;
      max-width: 100vw;
    }

    .modal, .modal-content, .modal-body {
      max-width: 100vw !important;
      overflow-x: hidden !important;
    }
    .answer-comparison, .review-mcq-options {
      max-width: 100vw !important;
      overflow-x: hidden !important;
      box-sizing: border-box;
    }
  </style>
</head>
<body>
  <nav>
    <div class="nav-container">
      <div class="nav-brand">
        <span class="app-name">Limit</span>
      </div>
      <div class="nav-links">
        <button class="nav-btn active" data-page="home">
          <img src="icons/Home.svg" alt="Home"> Home
        </button>
        <button class="nav-btn" data-page="questions">
          <img src="icons/Questions.svg" alt="Questions"> Questions
        </button>
        <button class="nav-btn" data-page="modules">
          <img src="icons/Modules.svg" alt="Modules"> Modules
        </button>
        <button class="nav-btn" data-page="settings">
          <img src="icons/Settings.svg" alt="Settings"> Settings
        </button>
      </div>
    </div>
  </nav>
  <nav id="breadcrumb" style="display:none;max-width:1200px;margin:0 auto 1.5rem auto;padding:0 1.5rem;font-size:1.05rem;color:var(--text-secondary);background:none;"></nav>

  <main>
    <!-- Home Page -->
    <section id="home" class="page active">
      <h2>Your Learning Modules</h2>
      <div class="card-list" id="module-list"></div>
    </section>

    <!-- Quiz Page -->
    <section id="quiz" class="page">
      <div class="quiz-container">
        <div class="progress-container">
          <div class="progress-label">
            <span>Progress</span>
            <span id="progress-count-text">0/0</span>
          </div>
          <div class="progress">
            <div id="progress-count" class="progress-bar"></div>
          </div>
        </div>
        <div class="progress-container">
          <div class="progress-label">
            <span>Accuracy</span>
            <span id="progress-accuracy-text">0%</span>
          </div>
          <div class="progress">
            <div id="progress-accuracy" class="progress-bar"></div>
          </div>
        </div>
        <div id="quiz-content"></div>
      </div>
    </section>

    <!-- Questions Page -->
    <section id="questions" class="page">
      <div class="page-header">
        <div class="header-content">
          <h2>Question Bank</h2>
          <p class="page-subtitle">Manage and organize your question bank</p>
        </div>
        <div class="header-actions">
          <button class="action-btn secondary" id="export-questions">
            <img src="icons/Export.svg" alt="">
            <span>Export</span>
          </button>
          <button class="action-btn secondary" id="import-questions">
            <img src="icons/Import.svg" alt="">
            <span>Import</span>
          </button>
          <button class="action-btn primary" id="add-question">
            <img src="icons/Add_white.svg" alt="">
            <span>Add Question</span>
          </button>
        </div>
      </div>
      
      <div class="search-row">
        <div class="search-group search-bar tag-search">
          <span class="search-icon">
            <img src="icons/Tag.svg" alt="Tags">
          </span>
          <input type="text" id="tag-search" class="search-input" placeholder="Search by tags...">
        </div>
        
        <div class="search-group search-bar content-search">
          <span class="search-icon">
            <img src="icons/Search.svg" alt="Search">
          </span>
          <input type="text" id="content-search" class="search-input" placeholder="Search in questions, options, and explanations...">
        </div>
        
        <div class="analytics-badge" id="questions-count" style="margin-left: auto; display: flex; align-items: center; background: #f8fafc; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 500; color: #475569;">
          <img src="icons/Question.svg" alt="Questions" style="width: 18px; height: 18px; margin-right: 0.5rem; opacity: 0.8;">
          <span>0 questions</span>
        </div>
      </div>
      <div id="search-results-count" style="margin: 0.5rem 0; font-size: 0.9rem; color: #64748b; display: none;">
        <img src="icons/Search.svg" alt="Search" style="width: 14px; height: 14px; margin-right: 0.5rem; opacity: 0.7; vertical-align: middle;">
        <span>Showing 0 of 0 questions</span>
      </div>
      <div class="card-list" id="question-list"></div>
    </section>

    <!-- Question Create/Edit Page -->
    <section id="question-edit" class="page form-page">
      <div class="form-page-header">
        <h2 class="form-page-title" id="question-edit-title">Add Question</h2>
        <button class="action-btn secondary" id="cancel-question-edit">
          <img src="icons/Back.svg" alt=""> Cancel
        </button>
      </div>

      <div class="form-group">
        <label>Question Text</label>
        <div class="rich-toolbar" id="q-toolbar">
          <button data-cmd="bold" title="Bold"><img src="icons/Bold.svg" alt="Bold"></button>
          <button data-cmd="italic" title="Italic"><img src="icons/Italics.svg" alt="Italic"></button>
          <button data-cmd="underline" title="Underline"><img src="icons/Underline.svg" alt="Underline"></button>
          <button data-cmd="strikeThrough" title="Strikethrough"><img src="icons/Strikethrough.svg" alt="Strikethrough"></button>
          <button data-cmd="superscript" title="Superscript"><img src="icons/Superscript.svg" alt="Superscript"></button>
          <button data-cmd="subscript" title="Subscript"><img src="icons/Subscript.svg" alt="Subscript"></button>
          <button data-cmd="mathFont" title="Math Font"><img src="icons/Math Font.svg" alt="Math Font"></button>
          <button type="button" class="format-btn insert-table-btn" title="Insert Table">
            <img src="icons/Table.svg" alt="Insert Table">
          </button>
        </div>
        <div id="q-editor" contenteditable="true"></div>
      </div>

      <div class="form-group">
        <label>Answer Type</label>
        <select id="answer-type" class="form-control">
          <option value="typed">Typed Answer</option>
          <option value="mcq">Multiple Choice</option>
        </select>
      </div>

      <div id="typed-answer-group" class="form-group">
        <label>Typed Answer</label>
        <div class="rich-toolbar" id="a-toolbar">
          <button data-cmd="bold"><img src="icons/Bold.svg" alt="Bold"></button>
          <button data-cmd="italic"><img src="icons/Italics.svg" alt="Italic"></button>
          <button data-cmd="underline"><img src="icons/Underline.svg" alt="Underline"></button>
          <button data-cmd="strikeThrough"><img src="icons/Strikethrough.svg" alt="Strikethrough"></button>
          <button data-cmd="insertUnorderedList"><img src="icons/Bullet List.svg" alt="Bullet List"></button>
          <button data-cmd="insertOrderedList"><img src="icons/Numbered List.svg" alt="Numbered List"></button>
          <button data-cmd="superscript"><img src="icons/Superscript.svg" alt="Superscript"></button>
          <button data-cmd="subscript"><img src="icons/Subscript.svg" alt="Subscript"></button>
          <button data-cmd="mathFont"><img src="icons/Math Font.svg" alt="Math Font"></button>
          <button type="button" class="format-btn" id="insert-table-btn" title="Insert Table">
            <img src="icons/Table.svg" alt="Insert Table">
          </button>
        </div>
        <div id="a-editor" contenteditable="true"></div>
      </div>

      <!-- Explanation Input -->
      <div class="form-group">
        <label>Explanation</label>
        <div class="rich-toolbar" id="e-toolbar">
          <button data-cmd="bold"><img src="icons/Bold.svg" alt="Bold"></button>
          <button data-cmd="italic"><img src="icons/Italics.svg" alt="Italic"></button>
          <button data-cmd="underline"><img src="icons/Underline.svg" alt="Underline"></button>
          <button data-cmd="strikeThrough"><img src="icons/Strikethrough.svg" alt="Strikethrough"></button>
          <button data-cmd="insertUnorderedList"><img src="icons/Bullet List.svg" alt="Bullet List"></button>
          <button data-cmd="insertOrderedList"><img src="icons/Numbered List.svg" alt="Numbered List"></button>
          <button data-cmd="superscript"><img src="icons/Superscript.svg" alt="Superscript"></button>
          <button data-cmd="subscript"><img src="icons/Subscript.svg" alt="Subscript"></button>
          <button data-cmd="mathFont"><img src="icons/Math Font.svg" alt="Math Font"></button>
          <button type="button" class="format-btn" id="insert-table-btn" title="Insert Table">
            <img src="icons/Table.svg" alt="Insert Table">
          </button>
        </div>
        <div id="e-editor" contenteditable="true"></div>
      </div>

      <div id="mcq-group" class="form-group" style="display:none;">
        <label>Options</label>
        <div id="options-container"></div>
        <button class="btn btn-secondary" id="add-option">
          <img src="icons/Add.svg" alt=""> Add Option
        </button>
      </div>

      <div class="form-group">
        <label>Tags (comma-separated)</label>
        <input type="text" id="question-tags" class="form-control" placeholder="algebra, calculus, etc.">
      </div>

      <button class="btn" id="save-question">Save Question</button>
    </section>

    <!-- Modules Page -->
    <section id="modules" class="page">
      <div class="page-header">
        <div class="header-content">
          <h2>Learning Modules</h2>
          <p class="page-subtitle">Organize your learning materials into modules</p>
        </div>
        <div class="header-actions">
          <button class="action-btn secondary" id="import-modules">
            <img src="icons/Import.svg" alt="">
            <span>Import</span>
          </button>
          <button class="action-btn primary" id="create-module">
            <img src="icons/Add_white.svg" alt="">
            <span>Create Module</span>
          </button>
        </div>
      </div>
      
      <div class="search-row">
        <div class="search-group search-bar module-search">
          <span class="search-icon">
            <img src="icons/Search.svg" alt="Search">
          </span>
          <input type="text" id="module-search" class="search-input" placeholder="Search modules by name...">
        </div>
        
        <div class="analytics-badge" id="modules-count" style="margin-left: auto; display: flex; align-items: center; background: #f8fafc; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 500; color: #475569;">
          <img src="icons/Module.svg" alt="Modules" style="width: 18px; height: 18px; margin-right: 0.5rem; opacity: 0.8;">
          <span>0 modules</span>
        </div>
      </div>
      <div class="card-list" id="module-manage-list"></div>
    </section>

    <!-- Module Create/Edit Page -->
    <section id="module-edit" class="page form-page">
      <div class="form-page-header">
        <h2 class="form-page-title" id="module-edit-title">Create Module</h2>
        <button class="action-btn secondary" id="cancel-module-edit">
          <img src="icons/Back.svg" alt=""> Cancel
        </button>
      </div>

      <div class="form-group">
        <label>Module Name</label>
        <input type="text" id="module-name" class="form-control" placeholder="Enter module name">
      </div>
      <div class="form-group">
        <label>Exam Module</label>
        <input type="checkbox" id="module-type-exam"> <span style="font-weight:500;">This is an exam module (timed, one attempt)</span>
      </div>
      <div id="exam-fields" style="display:none; margin-bottom: 1.5rem;">
        <div class="exam-fields-row" style="display: flex; gap: 1.5rem; align-items: flex-end; flex-wrap: wrap;">
          <div class="form-group" style="flex:1; min-width:180px;">
            <label for="exam-date" style="display:flex;align-items:center;gap:0.5rem;">
              <img src="icons/Time.svg" alt="Date" style="width:1.2em;height:1.2em;opacity:0.7;"> Exam Date
            </label>
            <input type="date" id="exam-date" class="form-control" placeholder="YYYY-MM-DD" title="Select the exam date">
          </div>
          <div class="form-group" style="flex:1; min-width:160px;">
            <label for="exam-time" style="display:flex;align-items:center;gap:0.5rem;">
              <img src="icons/Timer.svg" alt="Time" style="width:1.2em;height:1.2em;opacity:0.7;"> Start Time
            </label>
            <input type="time" id="exam-time" class="form-control" placeholder="HH:MM" title="Select the exam start time">
          </div>
          <div class="form-group" style="flex:1; min-width:140px;">
            <label for="exam-duration" style="display:flex;align-items:center;gap:0.5rem;">
              <img src="icons/Clock.svg" alt="Duration" style="width:1.2em;height:1.2em;opacity:0.7;"> Duration (min)
            </label>
            <input type="number" id="exam-duration" class="form-control" min="1" max="600" placeholder="e.g. 90" title="Enter the exam duration in minutes">
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>Module Description</label>
        <div class="rich-toolbar" id="m-toolbar">
          <button data-cmd="bold"><img src="icons/Bold.svg" alt="Bold"></button>
          <button data-cmd="italic"><img src="icons/Italics.svg" alt="Italic"></button>
          <button data-cmd="underline"><img src="icons/Underline.svg" alt="Underline"></button>
          <button data-cmd="strikeThrough"><img src="icons/Strikethrough.svg" alt="Strikethrough"></button>
          <button data-cmd="insertUnorderedList"><img src="icons/Bullet List.svg" alt="Bullet List"></button>
          <button data-cmd="insertOrderedList"><img src="icons/Numbered List.svg" alt="Numbered List"></button>
          <button data-cmd="superscript"><img src="icons/Superscript.svg" alt="Superscript"></button>
          <button data-cmd="subscript"><img src="icons/Subscript.svg" alt="Subscript"></button>
          <button data-cmd="mathFont"><img src="icons/Math Font.svg" alt="Math Font"></button>
          <button type="button" class="format-btn" id="insert-table-btn" title="Insert Table">
            <img src="icons/Table.svg" alt="Insert Table">
          </button>
        </div>
        <div id="m-editor" contenteditable="true"></div>
      </div>

      <h3>Select Questions</h3>
      <div class="card-list" id="module-question-select"></div>
      <button class="btn" id="save-module">Save Module</button>
    </section>

    <!-- Settings Page -->
    <section id="settings" class="page">
      <div class="page-header">
        <div class="header-content">
          <h2>Settings</h2>
          <p class="page-subtitle">Manage your app preferences and data</p>
        </div>
      </div>
      
      <div class="card">
        <h3>Appearance</h3>
        <div class="form-group">
          <label>Theme</label>
          <select id="theme-select" class="form-control">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
            <option value="system">System Default</option>
          </select>
        </div>
      </div>
      
      <div class="card">
        <h3>Data Management</h3>
        <p class="setting-description">Backup or restore all your app data including modules and questions.</p>
        
        <div class="setting-actions">
          <button id="export-all-data" class="action-btn secondary">
            <img src="icons/Export.svg" alt="">
            <span>Export All Data</span>
          </button>
          <button id="import-all-data" class="action-btn secondary">
            <img src="icons/Import.svg" alt="">
            <span>Import Data</span>
          </button>
        </div>
        <p class="setting-hint">
          <img src="icons/Info.svg" alt="Info" class="info-icon"> 
          Importing will replace all existing data. Make sure to export first if you want to keep a backup.
        </p>
      </div>
      
      <!-- Hidden file input for import -->
      <input type="file" id="import-file-input" accept=".json" style="display: none;">
    </section>
  </main>

    <!-- Import Comparison Modal -->
    <div id="import-comparison-modal" class="modal" style="display:none;">
      <div class="modal-content import-comparison" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
        <div class="modal-header">
          <h3>Review Import</h3>
          <span class="close" id="close-comparison-modal">&times;</span>
        </div>
        <div class="modal-body">
          <div class="import-summary">
            <div class="summary-item">
              <span class="summary-count" id="new-items-count">0</span>
              <span class="summary-label">New Items</span>
            </div>
            <div class="summary-item">
              <span class="summary-count" id="updated-items-count">0</span>
              <span class="summary-label">Updates</span>
            </div>
            <div class="summary-item">
              <span class="summary-count" id="duplicate-items-count">0</span>
              <span class="summary-label">Duplicates</span>
            </div>
          </div>
          
          <div class="import-tabs">
            <button class="tab-btn active" data-tab="questions-tab">Questions</button>
            <button class="tab-btn" data-tab="modules-tab">Modules</button>
          </div>
          
          <div class="import-content">
            <div id="questions-tab" class="tab-content active">
              <div class="import-section">
                <h4>New Questions</h4>
                <div id="new-questions" class="import-items">
                  <div class="empty-state">No new questions to import</div>
                </div>
              </div>
              <div class="import-section">
                <h4>Updated Questions</h4>
                <div id="updated-questions" class="import-items">
                  <div class="empty-state">No updated questions found</div>
                </div>
              </div>
              <div class="import-section">
                <h4>Duplicate Questions</h4>
                <div id="duplicate-questions" class="import-items">
                  <div class="empty-state">No duplicate questions found</div>
                </div>
              </div>
            </div>
            
            <div id="modules-tab" class="tab-content">
              <div class="import-section">
                <h4>New Modules</h4>
                <div id="new-modules" class="import-items">
                  <div class="empty-state">No new modules to import</div>
                </div>
              </div>
              <div class="import-section">
                <h4>Updated Modules</h4>
                <div id="updated-modules" class="import-items">
                  <div class="empty-state">No updated modules found</div>
                </div>
              </div>
              <div class="import-section">
                <h4>Duplicate Modules</h4>
                <div id="duplicate-modules" class="import-items">
                  <div class="empty-state">No duplicate modules found</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-import" class="btn btn-secondary">Cancel</button>
          <button id="confirm-import" class="btn btn-primary">Import Selected</button>
        </div>
      </div>
    </div>

    <!-- Table Insertion Modal -->
    <div id="table-insert-modal" class="modal" style="display:none;">
      <div class="modal-content" style="max-width: 400px; padding: 1.5rem;">
        <h3 style="margin-top: 0; margin-bottom: 1.5rem;">Insert Table</h3>
        <div class="form-group">
          <label for="table-rows">Rows:</label>
          <input type="number" id="table-rows" min="1" max="10" value="3" class="form-control" style="width: 80px;">
        </div>
        <div class="form-group">
          <label for="table-cols">Columns:</label>
          <input type="number" id="table-cols" min="1" max="10" value="3" class="form-control" style="width: 80px;">
        </div>
        <div class="form-group">
          <label for="table-class">Style:</label>
          <select id="table-class" class="form-control">
            <option value="">Default</option>
            <option value="bordered">Bordered</option>
            <option value="striped">Striped Rows</option>
            <option value="hover">Hover Rows</option>
          </select>
        </div>
        <div style="display: flex; justify-content: flex-end; gap: 0.75rem; margin-top: 1.5rem;">
          <button type="button" id="cancel-table-insert" class="btn btn-secondary">Cancel</button>
          <button type="button" id="confirm-table-insert" class="btn btn-primary">Insert</button>
        </div>
      </div>
    </div>

    <!-- Modal Structure -->
    <div id="modal-backdrop" class="modal-backdrop">
    <div class="modal">
      <div class="modal-body" id="modal-body"></div>
    </div>
  </div>

    <!-- Toasts -->
    <div class="toast-container" id="toasts" style="position: fixed; bottom: 1.5rem; left: 1.5rem; z-index: 1000; display: flex; flex-direction: column-reverse; gap: 0.75rem; max-width: calc(100% - 3rem); pointer-events: none;"></div>

  <!-- KaTeX Equation Editor Modal -->
  <div id="katex-modal-backdrop" class="modal-backdrop">
    <div class="modal equation-modal">
      <div class="modal-body equation-modal-body">
        <h3 class="equation-modal-title">Insert/Edit Equation</h3>
        <label for="katex-input" class="equation-modal-label">LaTeX Code</label>
        <input id="katex-input" class="form-control equation-modal-input" type="text" placeholder="e.g. x^2 + y^2 = z^2">
        <div class="equation-modal-preview-label">Preview</div>
        <div id="katex-preview" class="equation-modal-preview"></div>
        <div class="equation-modal-actions">
          <button class="btn" id="katex-insert-btn">Insert</button>
          <button class="btn btn-secondary" id="katex-cancel-btn">Cancel</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Table Insertion Modal -->
  <div id="table-insert-modal" class="table-insert-modal">
    <div class="table-insert-dialog">
      <h3>Insert Table</h3>
      <div class="table-size-inputs">
        <div class="table-size-input">
          <label for="table-rows">Rows</label>
          <input type="number" id="table-rows" min="1" max="10" value="3">
        </div>
        <div class="table-size-input">
          <label for="table-cols">Columns</label>
          <input type="number" id="table-cols" min="1" max="10" value="3">
        </div>
      </div>
      <div class="table-insert-actions">
        <button type="button" class="cancel-btn">Cancel</button>
        <button type="button" class="insert-btn">Insert Table</button>
      </div>
    </div>
  </div>

  <!-- KaTeX CSS and JS -->
  <link rel="stylesheet" href="katex/katex.min.css">
  <script src="katex/katex.min.js"></script>
  <script src="katex/mhchem.min.js"></script>
  <script src="katex/contrib/auto-render.min.js"></script>
  <!-- MathJS -->
  <script src="mathjs/math.min.js"></script>
  
  <!-- Loading Spinner Handler -->
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    // Function to initialize random spinners
    function initRandomSpinners() {
      const spinners = document.querySelectorAll('.spinner[data-random]');
      const spinnerTypes = ['', 'dots', 'orbit', 'pulse'];
      const loadingMessages = [
        'Crunching numbers...',
        'Thinking hard...',
        'Solving equations...',
        'Almost there...',
        'Just a moment...',
        'Working on it...'
      ];
      
      spinners.forEach(spinner => {
        // Add random spinner type
        const randomType = spinnerTypes[Math.floor(Math.random() * spinnerTypes.length)];
        if (randomType) spinner.classList.add(randomType);
        
        // For dots spinner, add the additional span
        if (randomType === 'dots') {
          const span = document.createElement('span');
          spinner.appendChild(span);
        }
        
        // Add random loading message if there's a message container
        const messageContainer = spinner.closest('.loading-container')?.querySelector('.loading-text');
        if (messageContainer) {
          const randomMessage = loadingMessages[Math.floor(Math.random() * loadingMessages.length)];
          messageContainer.textContent = randomMessage;
        }
      });
    }
    
    // Initialize spinners on page load
    initRandomSpinners();
    
    // Function to show a loading state
    window.showLoading = function(container) {
      container = container || document.body;
      const loadingId = 'loading-' + Math.random().toString(36).substr(2, 9);
      const loadingHtml = `
        <div class="loading-container" style="text-align: center; padding: 2rem;">
          <div class="spinner" data-random></div>
          <div class="loading-text"></div>
        </div>
      `;
      
      const loadingElement = document.createElement('div');
      loadingElement.id = loadingId;
      loadingElement.innerHTML = loadingHtml;
      container.appendChild(loadingElement);
      
      // Initialize the new spinner
      initRandomSpinners();
      
      return loadingId;
    };
    
    // Function to hide a loading state
    window.hideLoading = function(loadingId) {
      const element = document.getElementById(loadingId);
      if (element) {
        element.remove();
      }
    };
  });
  </script>
  
  <!-- Back to Top Button -->
  <button id="back-to-top" aria-label="Back to top">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M18 15l-6-6-6 6"/>
    </svg>
  </button>

  <!-- Initialize app -->
  <script>
    // Initialize app when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize back to top button
      const backToTopButton = document.getElementById('back-to-top');
      if (backToTopButton) {
        // Show/hide button based on scroll position
        window.addEventListener('scroll', () => {
          if (window.pageYOffset > 300) {
            backToTopButton.classList.add('show');
          } else {
            backToTopButton.classList.remove('show');
          }
        });

        // Smooth scroll to top when clicked
        backToTopButton.addEventListener('click', () => {
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        });
      }
      
      // Initialize database
      openDB();
      
      // Show loading state for modules
      const moduleList = document.getElementById('module-list');
      if (moduleList) {
        moduleList.innerHTML = `
          <div class="loading-spinner" style="grid-column: 1 / -1; display: flex; justify-content: center; padding: 2rem;">
            <div class="spinner"></div>
          </div>
        `;
      }
      
      // Set up theme toggle
      const themeToggle = document.getElementById('theme-toggle');
      if (themeToggle) {
        themeToggle.innerHTML = `<img src="icons/light-mode.svg" alt="Toggle Theme">`;
        themeToggle.addEventListener('click', toggleTheme);
      }

      // Set up question and module search
      const questionSearch = document.getElementById('question-search');
      const moduleSearch = document.getElementById('module-search');
      
      if (questionSearch) {
        questionSearch.addEventListener('input', debounce(loadQuestionsList, 300));
      }
      
      if (moduleSearch) {
        moduleSearch.addEventListener('input', debounce(loadModulesManage, 300));
      }
    });

    // Debounce function for search inputs
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }
  </script>
  
  <!-- App Script -->
  <script src="app.js"></script>

  <!-- Add this before the closing </main> tag -->
  <section id="module-review" class="page">
    <div class="review-header" style="max-width:1200px;margin:2rem auto 0 auto;display:flex;justify-content:space-between;align-items:center;padding-bottom:1rem;border-bottom:1px solid var(--border);">
      <h2 class="review-title">Module Review</h2>
      <button class="btn btn-secondary" id="back-to-modules">
        <img src="icons/Back.svg" alt=""> Back to Modules
      </button>
    </div>
    <div class="card-list" id="review-questions" style="max-width:1200px;margin:2rem auto;"></div>
  </section>
</body>
</html>
